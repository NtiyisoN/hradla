var $__src_47_es6_47_structuresAndClasses_46_js__=function(){"use strict";var t=null,e=function(){return $traceurRuntime.createClass(function(){return t||(t=this),this.prefix="id",this.nextId=0,t},{get unique(){for(var t=this.generate();$("#"+t).length;)this.nextId++,t=this.generate();return this.nextId++,t},generate:function(){return this.prefix+this.nextId}},{})}(),n=function(){return $traceurRuntime.createClass(function(t){this.map=new Map,this.default=t},{get size(){return this.map.size},clear:function(){return this.map.clear()},forEach:function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(t=this.map).forEach.apply(t,$traceurRuntime.spread(e))},get:function(t){return this.map.get(t)},delete:function(t){return this.map.delete(t)},set:function(t,e){return this.map.set(t,e)},has:function(t){return this.map.has(t)},entries:function(){return this.map.entries()},keys:function(){return this.map.keys()},values:function(){return this.map.values()}},{})}();return{get Id(){return e},get MapWithDefaultValue(){return n}}}(),$__src_47_es6_47_svgObjects_46_js__=function(){"use strict";var t=$__src_47_es6_47_structuresAndClasses_46_js__,e=function(){return $traceurRuntime.createClass(function(e){this.tagName=e,this.$el=$("<"+this.tagName+">"),this.id=(new t.Id).unique},{addClass:function(t){this.$el.addClass(t)},removeClasses:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=!0,i=!1,r=void 0;try{for(var s=void 0,o=t[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var a=s.value;this.$el.removeClass(a)}}catch(t){i=!0,r=t}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}},addAttr:function(t){this.checkIfElementExistsInDOM(),this.$el.attr(t)},getAttr:function(t){return this.checkIfElementExistsInDOM(),this.$el.attr(t)},removeAttr:function(t){this.checkIfElementExistsInDOM(),this.$el.removeAttr(t)},set id(t){this.addAttr({id:t})},get id(){return this.getAttr("id")},get:function(){return this.checkIfElementExistsInDOM(),this.$el},checkIfElementExistsInDOM:function(){var t=$("#"+this.$el.attr("id"));t.length&&(this.$el=t)}},{})}(),n=function(t){function e(t){$traceurRuntime.superConstructor(e).call(this,t)}return $traceurRuntime.createClass(e,{draggable:function(t){this.addAttr({draggable:t})}},{},t)}(e),i=(function(t){function e(t){$traceurRuntime.superConstructor(e).call(this,t)}$traceurRuntime.createClass(e,{rotatable:function(t){this.addAttr({rotatable:t})}},{},t)}(e),function(t){function e(t){$traceurRuntime.superConstructor(e).call(this,t)}return $traceurRuntime.createClass(e,{rotatable:function(t){this.addAttr({rotatable:t})}},{},t)}(n)),r=function(t){function e(t,n,i,r,s){$traceurRuntime.superConstructor(e).call(this,s),this.addAttr({x:t,y:n,width:i,height:r})}return $traceurRuntime.createClass(e,{},{},t)}(i),s=function(t){function e(t,n,i,r,s,o){$traceurRuntime.superConstructor(e).call(this,t,n,i,r,"rect"),this.addAttr({fill:s,stroke:o,"stroke-width":.5,"pointer-events":"all"})}return $traceurRuntime.createClass(e,{},{},t)}(r),o=function(t){function e(t,n,i,r,s){$traceurRuntime.superConstructor(e).call(this,t,n,i,r,"image"),this.addAttr({"xlink:href":s})}return $traceurRuntime.createClass(e,{changeUrl:function(t){this.addAttr({"xlink:href":t})}},{},t)}(r),a=function(t){function e(){$traceurRuntime.superConstructor(e).call(this,"g")}return $traceurRuntime.createClass(e,{addChild:function(t){return this.$el.append(t.$el),t}},{},t)}(i),h=function(){function t(t,e){this.x=0,this.y=0,void 0!==t&&void 0!==e&&(this.x=t,this.y=e)}return $traceurRuntime.createClass(t,{set:function(t,e){this.x=t,this.y=e},get string(){return this.x+","+this.y}},{parseFromString:function(e){var n=e.split(",");return new t(n[0],n[1])},equals:function(t,e){return t.x===e.x&&t.y===e.y}})}(),u=function(t){function e(t){$traceurRuntime.superConstructor(e).call(this,t)}return $traceurRuntime.createClass(e,{copy:function(){return new e($.extend(!0,[],this.arr))},append:function(t){$traceurRuntime.superGet(this,e.prototype,"append").call(this,t);var n=this.length;return n>=3&&(this.getItem(n-3).x===this.getItem(n-2).x&&this.getItem(n-2).x===this.getItem(n-1).x||this.getItem(n-3).y===this.getItem(n-2).y&&this.getItem(n-2).y===this.getItem(n-1).y)&&this.remove(n-2),this},get string(){for(var t="",e=0;e<this.length;++e)0!==e&&(t+=" "),t+=this.arr[e].string;return t},forEach:function(t){for(var e=0;e<this.arr.length;++e)t(this.arr[e])}},{parseFromString:function(t){for(var n=t.split(" "),i=new e,r=0;r<n.length;++r)i.append(h.parseFromString(n[r]));return i}},t)}(function(){function t(t){this.arr=void 0!==t?t:[]}return $traceurRuntime.createClass(t,{copy:function(){return t($.extend(!0,[],this.arr))},append:function(t){return this.addWithIndex(t,this.arr.length)},prepend:function(t){return this.addWithIndex(t,0)},addWithIndex:function(t,e){for(var n=this.arr.length;n>e;--n)this.arr[n]=this.arr[n-1];return this.arr[e]=t,this},get length(){return this.arr.length},getItem:function(t){return this.arr[t]},get last(){return 0!==this.length&&this.arr[this.length-1]},get first(){return 0!==this.length&&this.arr[0]},remove:function(t){for(var e=this.length,n=t;n<e;++n)this.arr[n]=this.arr[n+1];this.arr.pop()}},{})}()),c=function(t){function e(t,n,i){$traceurRuntime.superConstructor(e).call(this,"polyline"),this.addAttr({points:t.string,stroke:n,fill:"none","stroke-width":i})}return $traceurRuntime.createClass(e,{updatePoints:function(t){this.addAttr({points:t.string})}},{},t)}(e),l=function(t){function e(t,n,i){$traceurRuntime.superConstructor(e).call(this,"pattern"),this.addAttr({id:t,x:0,y:0,width:n,height:i,patternUnits:"userSpaceOnUse",viewBox:"0 0 "+n+" "+i})}return $traceurRuntime.createClass(e,{addChild:function(t){return this.$el.append(t.$el),t}},{},t)}(e);return{get Rectangle(){return s},get SvgImage(){return o},get Group(){return a},get PolylinePoint(){return h},get PolylinePoints(){return u},get PolyLine(){return c},get Pattern(){return l}}}(),$__src_47_es6_47_logic_46_js__=function(){"use strict";var t=function(){function t(){}return $traceurRuntime.createClass(t,{},{and:function(e,n){return t.testLogicRulesSymmetric(e,n,[[t.state.on,t.state.on,t.state.on],[t.state.on,t.state.off,t.state.off],[t.state.on,t.state.unknown,t.state.unknown],[t.state.on,t.state.oscillating,t.state.oscillating],[t.state.off,t.state.off,t.state.off],[t.state.off,t.state.unknown,t.state.off],[t.state.off,t.state.oscillating,t.state.off],[t.state.unknown,t.state.unknown,t.state.unknown],[t.state.unknown,t.state.oscillating,t.state.unknown],[t.state.oscillating,t.state.oscillating,t.state.oscillating]])},nand:function(e,n){return t.not(t.and(e,n))},nor:function(e,n){return t.not(t.or(e,n))},not:function(e){return e===t.state.on?t.state.off:e===t.state.off?t.state.on:e},or:function(e,n){return t.testLogicRulesSymmetric(e,n,[[t.state.on,t.state.on,t.state.on],[t.state.on,t.state.off,t.state.on],[t.state.on,t.state.unknown,t.state.on],[t.state.on,t.state.oscillating,t.state.on],[t.state.off,t.state.off,t.state.off],[t.state.off,t.state.unknown,t.state.unknown],[t.state.off,t.state.oscillating,t.state.oscillating],[t.state.unknown,t.state.unknown,t.state.unknown],[t.state.unknown,t.state.oscillating,t.state.unknown],[t.state.oscillating,t.state.oscillating,t.state.oscillating]])},xnor:function(e,n){return t.not(t.xor(e,n))},xor:function(e,n){return t.testLogicRulesSymmetric(e,n,[[t.state.on,t.state.on,t.state.off],[t.state.on,t.state.off,t.state.on],[t.state.on,t.state.unknown,t.state.unknown],[t.state.on,t.state.oscillating,t.state.oscillating],[t.state.off,t.state.off,t.state.off],[t.state.off,t.state.unknown,t.state.unknown],[t.state.off,t.state.oscillating,t.state.oscillating],[t.state.unknown,t.state.unknown,t.state.unknown],[t.state.unknown,t.state.oscillating,t.state.unknown],[t.state.oscillating,t.state.oscillating,t.state.oscillating]])},get state(){return{unknown:0,on:1,off:2,oscillating:3}},testLogicRulesSymmetric:function(t,e,n){for(var i=0;i<n.length;i++)if(n[i][0]===t&&n[i][1]===e||n[i][0]===e&&n[i][1]===t)return n[i][2]}})}();return{get default(){return t}}}(),$__src_47_es6_47_editorElements_46_js__=function(){"use strict";var t=$__src_47_es6_47_svgObjects_46_js__,e=$__src_47_es6_47_structuresAndClasses_46_js__,n=$__src_47_es6_47_logic_46_js__.default,i={on:"stateOn",off:"stateOff",unknown:"stateUnknown",oscillating:"stateOscillating"},r=function(){return $traceurRuntime.createClass(function(t){void 0!==t&&(this.name=t.replace(/^[ ]*([^(]+).*/,"$1"),this.args=t.replace(/^[^(]+\((.*)\)/,"$1").split(" "))},{setName:function(t){this.name=t},setArguments:function(t){this.args=t},get:function(){return this.name+"("+this.args.join(" ")+")"}},{})}(),s=function(){return $traceurRuntime.createClass(function(t){if(this.items=[],void 0!==t)for(var e=t.split(")"),n=0;n<e.length;n++)e[n]&&this.items.push(new r(e[n]+")"))},{getIndex:function(t){for(var e=0;e<this.items.length;e++)if(t===this.items[e].name)return e;return-1},getTranslate:function(){var t=this.getArguments(this.getIndex("translate"));return{x:t[0],y:t[1]}},getRotate:function(){var t=this.getArguments(this.getIndex("rotate"));return{deg:t[0],centreX:t[1],centreY:t[2]}},setTranslate:function(t,e){this.setParameter("translate",[t,e])},setRotate:function(t,e,n){this.setParameter("rotate",[t,e,n])},rotateRight:function(t,e){if(-1===this.getIndex("rotate"))this.setRotate(90,t,e);else{var n=(parseInt(this.getRotate().deg)+90)%360;if(180===n){var i=t;t=e,e=i}this.setRotate(n,t,e)}},get:function(){for(var t="",e=0;e<this.items.length;e++)0!==e&&(t+=" "),t+=this.items[e].get();return t},getArguments:function(t){return this.items[t].args},setParameter:function(t,e){var n=this.getIndex(t);-1===n&&(n=this.items.length,this.items[n]=new r,this.items[n].setName(t)),this.items[n].setArguments(e)}},{})}(),o=function(){return $traceurRuntime.createClass(function(t){t||console.error("Parent SVG element has not been defined."),this.parentSVG=t,this.svgObj=void 0},{get id(){return this.svgObj.id},onMouseDown:function(){},onMouseUp:function(){},onMouseMove:function(){},get exportData(){console.error("'json' getter has not been defined for this element",this)}},{})}(),a=function(e){function r(e,s,o,a){$traceurRuntime.superConstructor(r).call(this,e),this.gridSize=s,this.connectorSize=s,this.connectorOffset=this.connectorSize/2,this.svgObj=new t.Rectangle(o*this.gridSize-this.connectorOffset,a*this.gridSize-this.connectorOffset,this.connectorSize,this.connectorSize,"none","black"),this.svgObj.$el.addClass("connector"),this.stateAttr=!1,this.isInputConnector=!1,this.stateAttr=n.state.unknown,this.svgObj.addClass(i.unknown),this.wireIds=new Set}return $traceurRuntime.createClass(r,{get isOutputConnector(){return!this.isInputConnector},addWireId:function(t){this.wireIds.add(t)},removeWireId:function(t){this.wireIds.delete(t)},removeWireIdAndUpdate:function(t){this.removeWireId(t)},setState:function(t,e){switch(this.svgObj.removeClasses(i.on,i.off,i.unknown,i.oscillating),t){case n.state.unknown:this.svgObj.addClass(i.unknown);break;case n.state.on:this.svgObj.addClass(i.on);break;case n.state.off:this.svgObj.addClass(i.off);break;case n.state.oscillating:this.svgObj.addClass(i.oscillating)}this.stateAttr=t},get state(){return this.stateAttr},get:function(){return this.svgObj},onMouseUp:function(){this.parentSVG.wireCreationHelper(this.svgObj.id)}},{get type(){return{inputConnector:0,outputConnector:1}}},e)}(o),h=function(t){function e(t,n,i,r){$traceurRuntime.superConstructor(e).call(this,t,n,i,r),this.type=a.type.inputConnector,this.isInputConnector=!0}return $traceurRuntime.createClass(e,{setState:function(t){$traceurRuntime.superGet(this,e.prototype,"setState").call(this,t),this.parentSVG.getBoxByConnectorId(this.svgObj.id).refreshState()},removeWireIdAndUpdate:function(t){$traceurRuntime.superGet(this,e.prototype,"removeWireIdAndUpdate").call(this,t),this.setState(n.state.unknown)},get state(){return $traceurRuntime.superGet(this,e.prototype,"state")}},{},t)}(a),u=function(t){function e(t,n,i,r){$traceurRuntime.superConstructor(e).call(this,t,n,i,r),this.isOutput=!0,this.type=a.type.outputConnector}return $traceurRuntime.createClass(e,{setState:function(t){$traceurRuntime.superGet(this,e.prototype,"setState").call(this,t);var n=!0,i=!1,r=void 0;try{for(var s=void 0,o=this.wireIds[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var a=s.value;this.parentSVG.getWireById(a).setState(t)}}catch(t){i=!0,r=t}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}},get state(){return $traceurRuntime.superGet(this,e.prototype,"state")}},{},t)}(a),c=function(e){function n(e,i,r,s,o){$traceurRuntime.superConstructor(n).call(this,e),this.name=i,this.category=r,this.gridSize=this.parentSVG.gridSize,this.url="img/"+this.category+"/"+this.name+".svg",this.connectors=[],this.svgObj=new t.Group,this.width=s*this.gridSize,this.height=o*this.gridSize,this.gridWidth=s,this.gridHeight=o;var a=new t.Rectangle(0,0,this.width,this.height,"none","none");a.$el.addClass("rect"),this.svgObj.addChild(a),this.image=new t.SvgImage(0,0,this.width,this.height,this.url),this.svgObj.addChild(this.image),this.svgObj.draggable(!0),this.svgObj.rotatable(!0),this.svgObj.addAttr({type:r}),this.svgObj.$el.addClass("box"),this.svgObj.$el.addClass(r),this.generateBlockNodes()}return $traceurRuntime.createClass(n,{get inputConnectors(){return this.connectors.filter(function(t){return t.isInputConnector})},get outputConnectors(){return this.connectors.filter(function(t){return t.isOutputConnector})},get exportData(){var t=[],e=0,n=!0,i=!1,r=void 0;try{for(var s=void 0,o=this.connectors[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var a=s.value,h=!0,u=!1,c=void 0;try{for(var l=void 0,d=a.wireIds[Symbol.iterator]();!(h=(l=d.next()).done);h=!0){var f=l.value,g=void 0;this.parentSVG.exportWireIdMap.has(f)?g=this.parentSVG.exportWireIdMap.get(f):(this.parentSVG.exportWireIdMap.set(f,this.parentSVG.exportWireId),g=this.parentSVG.exportWireId,this.parentSVG.exportWireId++),t[t.length]={index:e,type:a.type,wireId:g}}}catch(t){u=!0,c=t}finally{try{h||null==d.return||d.return()}finally{if(u)throw c}}e++}}catch(t){i=!0,r=t}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}return{name:this.name,category:this.category,transform:this.getTransform(),connections:t}},generateBlockNodes:function(){for(var t=void 0!==arguments[0]?arguments[0]:0,e=void 0!==arguments[1]?arguments[1]:0,n=void 0!==arguments[2]?arguments[2]:0,i=void 0!==arguments[3]?arguments[3]:0,r=[],s=4;s<arguments.length;s++)r[s-4]=arguments[s];this.blockedNodes=new Set;for(var o=i;o<=this.gridWidth-e;o++)for(var a=t;a<=this.gridHeight-n;a++)this.blockedNodes.add({x:o,y:a});var h=!0,u=!1,c=void 0;try{for(var l=void 0,d=r[Symbol.iterator]();!(h=(l=d.next()).done);h=!0){var f=l.value;this.blockedNodes.add(f)}}catch(t){u=!0,c=t}finally{try{h||null==d.return||d.return()}finally{if(u)throw c}}},refreshState:function(){console.warn("Calling the virtual function refreshState has no effect.")},changeImage:function(t){t=void 0===t||""===t?"":"-"+t,this.url="img/"+this.category+"/"+this.name+t+".svg",this.image.changeUrl(this.url)},get:function(){return this.svgObj.get()},removeBlockedNode:function(t,e){var n=!0,i=!1,r=void 0;try{for(var s=void 0,o=this.blockedNodes[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var a=s.value;if(a.x===t&&a.y===e){this.blockedNodes.delete(a);break}}}catch(t){i=!0,r=t}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}},rotateBlockedNodesRight:function(){var t=this;if(void 0!==this.rotation&&4!==this.rotation||(this.rotation=0),this.rotation++,1===this.rotation||3===this.rotation){var e=new Set;this.blockedNodes.forEach(function(n){e.add({x:Math.abs(n.y-t.gridHeight),y:n.x})}),this.blockedNodes=e}else if(2===this.rotation||4===this.rotation){var n=new Set;this.blockedNodes.forEach(function(e){n.add({x:Math.abs(e.y-t.gridWidth),y:e.x})}),this.blockedNodes=n}},addConnector:function(t,e,n){var i=this.connectors.length;n===a.type.inputConnector?this.connectors[i]=new h(this.parentSVG,this.gridSize,t,e):this.connectors[i]=new u(this.parentSVG,this.gridSize,t,e),this.svgObj.addChild(this.connectors[i].get()),this.removeBlockedNode(t,e)},getConnectorById:function(t){for(var e=0;e<this.connectors.length;e++)if(this.connectors[e].id===t)return this.connectors[e]},getTransform:function(){var t;return this.svgObj.$el.attr("transform")?t=new s(this.svgObj.$el.attr("transform")):((t=new s).setTranslate(0,0),this.svgObj.addAttr({transform:t.get()})),t},setTransform:function(t){this.svgObj.addAttr({transform:t.get()})},onMouseDown:function(t){this.mouseLeft=!1,1===t.which&&(this.mouseLeft=!0,this.onMouseDownLeft(t),this.parentSVG.moveToFrontById(this.svgObj.id))},onMouseDownLeft:function(t){this.mouseMoved=!1;var e=this.getTransform().getTranslate();this.offset={x:t.pageX-e.x,y:t.pageY-e.y}},onMouseMove:function(t){if(this.mouseLeft){this.mouseMoved=!0;var e=t.pageX-this.offset.x,n=t.pageY-this.offset.y,i=this.getTransform();i.setTranslate(e,n),this.setTransform(i),this.updateWires(!0)}},onMouseUp:function(t){1===t.which?this.mouseMoved?this.onDrop(t):this.onClick():2===t.which&&this.onClickMiddle()},onDrop:function(t){var e=t.pageX-this.offset.x,n=t.pageY-this.offset.y;e=this.parentSVG.snapToGrid(e),n=this.parentSVG.snapToGrid(n);var i=this.getTransform();i.setTranslate(e,n),this.setTransform(i),this.updateWires()},onClick:function(){},onClickMiddle:function(){var t=this.getTransform(),e=this.svgObj.$el[0].getBoundingClientRect(),n=Math.round(e.width/2),i=Math.round(e.height/2);n-=n%this.gridSize,i-=i%this.gridSize,t.rotateRight(n,i),this.svgObj.addAttr({transform:t.get()}),this.rotateBlockedNodesRight(),this.updateWires()},updateWires:function(){var t=void 0!==arguments[0]&&arguments[0],e=this;this.connectors.forEach(function(n){n.wireIds.forEach(function(n){var i=e.parentSVG.getWireById(n);t?i.temporaryWire():i.routeWire()})})}},{},e)}(o),l=function(t){function e(t){var n=void 0!==arguments[1]&&arguments[1];$traceurRuntime.superConstructor(e).call(this,t,"input","io",7,4),this.addConnector(7,2,a.type.outputConnector),this.on=n}return $traceurRuntime.createClass(e,{get exportData(){var t=$traceurRuntime.superGet(this,e.prototype,"exportData");return t.isOn=this.isOn,t},generateBlockNodes:function(){$traceurRuntime.superGet(this,e.prototype,"generateBlockNodes").call(this,0,1,1,0)},refreshState:function(){this.parentSVG.startNewSimulation(this.connectors[0],this.connectors[0].state)},set on(t){t?(this.changeImage("on"),this.connectors[0].setState(n.state.on),this.refreshState()):(this.changeImage(),this.connectors[0].setState(n.state.off),this.refreshState()),this.isOn=t},get on(){return this.isOn},onClick:function(){this.on=!this.on}},{},t)}(c),d=function(t){function e(t){$traceurRuntime.superConstructor(e).call(this,t,"output","io",5,4),this.addConnector(0,2,a.type.inputConnector)}return $traceurRuntime.createClass(e,{refreshState:function(){this.setState(this.connectors[0].state)},setState:function(t){switch(t){case n.state.on:this.changeImage("on");break;case n.state.off:this.changeImage("off");break;case n.state.unknown:this.changeImage();break;case n.state.oscillating:this.changeImage("osc")}},generateBlockNodes:function(){$traceurRuntime.superGet(this,e.prototype,"generateBlockNodes").call(this,0,0,0,1)}},{},t)}(c),f=function(t){function e(t,n){$traceurRuntime.superConstructor(e).call(this,t,n,"gate",9,4),this.addConnector(9,2,a.type.outputConnector),"not"===this.name?this.addConnector(0,2,a.type.inputConnector):(this.addConnector(0,1,a.type.inputConnector),this.addConnector(0,3,a.type.inputConnector),this.generateBlockNodes({x:0,y:2})),this.refreshState()}return $traceurRuntime.createClass(e,{generateBlockNodes:function(t){void 0!==t?$traceurRuntime.superGet(this,e.prototype,"generateBlockNodes").call(this,0,1,0,1,t):$traceurRuntime.superGet(this,e.prototype,"generateBlockNodes").call(this,0,1,0,1)},refreshState:function(){var t=n.state.unknown;switch(this.name){case"and":t=n.and(this.connectors[1].state,this.connectors[2].state);break;case"nand":t=n.nand(this.connectors[1].state,this.connectors[2].state);break;case"nor":t=n.nor(this.connectors[1].state,this.connectors[2].state);break;case"not":t=n.not(this.connectors[1].state);break;case"or":t=n.or(this.connectors[1].state,this.connectors[2].state);break;case"xnor":t=n.xnor(this.connectors[1].state,this.connectors[2].state);break;case"xor":t=n.xor(this.connectors[1].state,this.connectors[2].state)}this.parentSVG.simulation.notifyChange(this.connectors[0].id,t)}},{},t)}(c),g=function(r){function s(t,e,i,r){var o=void 0===arguments[4]||arguments[4];$traceurRuntime.superConstructor(s).call(this,t),this.gridSize=r,this.fromId=e,this.toId=i,this.startBox=this.parentSVG.getBoxByConnectorId(e),this.endBox=this.parentSVG.getBoxByConnectorId(i),this.boxes=[this.startBox,this.endBox],this.startConnector=this.parentSVG.getConnectorById(e),this.endConnector=this.parentSVG.getConnectorById(i),this.connectors=[this.startConnector,this.endConnector],this.routeWire(!0,o),this.stateAttr=n.state.unknown;var a=!0,h=!1,u=void 0;try{for(var c=void 0,l=this.connectors[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var d=c.value;d.isOutput&&this.setState(d.state)}}catch(t){h=!0,u=t}finally{try{a||null==l.return||l.return()}finally{if(h)throw u}}this.svgObj.$el.addClass("wire")}return $traceurRuntime.createClass(s,{get exportData(){return{fromId:this.fromId,toId:this.toId}},setState:function(t){switch(this.svgObj.removeClasses(i.on,i.off,i.unknown,i.oscillating),t){case n.state.unknown:this.svgObj.addClass(i.unknown);break;case n.state.on:this.svgObj.addClass(i.on);break;case n.state.off:this.svgObj.addClass(i.off);break;case n.state.oscillating:this.svgObj.addClass(i.oscillating)}this.startConnector.isInputConnector&&this.startConnector.setState(t),this.endConnector.isInputConnector&&this.endConnector.setState(t),this.stateAttr=t},get state(){return this.stateAttr},updateWireState:function(){var t=!0,e=!1,n=void 0;try{for(var i=void 0,r=this.boxes[Symbol.iterator]();!(t=(i=r.next()).done);t=!0)i.value.refreshState()}catch(t){e=!0,n=t}finally{try{t||null==r.return||r.return()}finally{if(e)throw n}}},get:function(){return this.svgObj.get()},getTemporaryWirePoints:function(){var e=new t.PolylinePoints;return e.append(new t.PolylinePoint(this.wireStart.x,this.wireStart.y)),e.append(new t.PolylinePoint(this.wireEnd.x,this.wireEnd.y)),e},temporaryWire:function(){this.wireStart=this.getCoordinates(this.startConnector,!1),this.wireEnd=this.getCoordinates(this.endConnector,!1),this.setWirePath(this.getTemporaryWirePoints())},routeWire:function(){var t=void 0===arguments[0]||arguments[0],e=void 0===arguments[1]||arguments[1];this.wireStart=this.getCoordinates(this.startConnector,t),this.wireEnd=this.getCoordinates(this.endConnector,t),this.points=this.aStar({x:this.wireStart.x/this.gridSize,y:this.wireStart.y/this.gridSize},{x:this.wireEnd.x/this.gridSize,y:this.wireEnd.y/this.gridSize}),this.setWirePath(this.points),e&&this.updateWireState()},setWirePath:function(e){void 0!==this.svgObj?this.svgObj.updatePoints(e):this.svgObj=new t.PolyLine(e,"#8b8b8b",2),this.svgObj.removeClasses(i.on,i.off,i.unknown,i.oscillating),this.svgObj.addClass(i.unknown),this.svgObj.addAttr({fromId:this.fromId,toId:this.toId})},aStar:function(n,i){var r=new Set,o=new Set;o.add(n);var a=new Map,h=new e.MapWithDefaultValue(1/0);h.set(n,0);var u=new e.MapWithDefaultValue(1/0);u.set(n,s.manhattanDistance(n,i));var c,l=this.parentSVG.getNonRoutableNodes();for(c=void 0===this.svgObj?this.parentSVG.getInconvenientNodes():this.parentSVG.getInconvenientNodes(this.svgObj.id);o.size>0;){var d=void 0,f=void 0,g=!0,p=!1,v=void 0;try{for(var m=void 0,y=o[Symbol.iterator]();!(g=(m=y.next()).done);g=!0){var w=m.value;(!d||u.get(w)<f)&&(d=w,f=u.get(d))}}catch(t){p=!0,v=t}finally{try{g||null==y.return||y.return()}finally{if(p)throw v}}if(t.PolylinePoint.equals(d,i))return this.reconstructPath(a,d);o.delete(d),r.add(d);for(var x=0;x<4;x++)for(var _=s.movePoint(d,x),C=0;C<50&&!s.setHasThisPoint(l,this.scalePointToGrid(_));C++)if(!r.has(_)){o.has(_).y||o.add(_);var b=1;0!==C&&(b=2);var $=h.get(d)+b;if(s.setHasThisPoint(c,this.scalePointToGrid(_))&&($+=1),!($>=h.get(_))){if(a.set(_,d),h.set(_,$),u.set(_,$+s.manhattanDistance(_,i)),s.setHasThisPoint(c,this.scalePointToGrid(_)))break;_=s.movePoint(_,x)}}if(o.size>5e4)break}return this.getTemporaryWirePoints()},scalePointToGrid:function(t){return{x:t.x*this.gridSize,y:t.y*this.gridSize}},reconstructPath:function(e,n){var i=new t.PolylinePoints;for(i.append(new t.PolylinePoint(n.x*this.gridSize,n.y*this.gridSize));e.has(n);)n=e.get(n),i.append(new t.PolylinePoint(n.x*this.gridSize,n.y*this.gridSize));return i},getCoordinates:function(t){var e=void 0===arguments[1]||arguments[1],n=(t.svgObj.id,t.svgObj.$el),i=n.position();i.left=this.parentSVG.viewbox.transformX(i.left),i.top=this.parentSVG.viewbox.transformY(i.top);var r=n.attr("width"),s=n.attr("height"),o=i.left+r/2,a=i.top+s/2;return e&&(o=this.parentSVG.snapToGrid(o),a=this.parentSVG.snapToGrid(a)),{x:o,y:a}}},{movePoint:function(t,e){switch(e){case 0:return{x:t.x,y:t.y-1};case 1:return{x:t.x+1,y:t.y};case 2:return{x:t.x,y:t.y+1};case 3:return{x:t.x-1,y:t.y}}},manhattanDistance:function(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)},setHasThisPoint:function(t,e){var n=!0,i=!1,r=void 0;try{for(var s=void 0,o=t[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var a=s.value;if(a.x===e.x&&a.y===e.y)return!0}}catch(t){i=!0,r=t}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}return!1}},r)}(o);return{get Transform(){return s},get InputConnector(){return h},get OutputConnector(){return u},get InputBox(){return l},get OutputBox(){return d},get Gate(){return f},get Wire(){return g}}}(),$__src_47_es6_47_contextMenu_46_js__=function(){"use strict";var t=function(){return $traceurRuntime.createClass(function(t,e,n,i,r){this.name=t,this.type=e,this.contextMenu=n,this.parentSVG=i,this.$el=$("<li>"),$(this.$el).text(t).attr("type",e),r&&$(this.$el).click(function(t){r(t),n.hide()})},{addClass:function(t){return this.$el.addClass(t),this},appendItem:function(t){return this.subList||(this.subList=$("<ul>"),this.$el.append(this.subList)),this.subList.append(t.jQuery),t},get jQuery(){return this.$el}},{})}(),e=function(t){function e(t,n,i){$traceurRuntime.superConstructor(e).call(this,t,t,n,i,function(e){var r={left:Math.round(n.position.x/i.gridSize)*i.gridSize,top:Math.round(n.position.y/i.gridSize)*i.gridSize};i.newGate(t,r.left,r.top)})}return $traceurRuntime.createClass(e,{},{},t)}(t),n=function(){return $traceurRuntime.createClass(function(n){var i=this;this.parentSVG=n;var r=["not","and","or","nand","nor","xor","xnor"];this.position={x:0,y:0},this.$el=$("<ul>"),this.$el.attr("id","contextMenu");for(var s=new t("New gate","",this,n),o=0;o<r.length;++o)s.appendItem(new e(r[o],this,n));this.appendItem(s),this.appendItem(new t("Input box","",this,n,function(){var t={left:i.parentSVG.snapToGrid(i.position.x),top:i.parentSVG.snapToGrid(i.position.y)};n.newInput(t.left,t.top)})),this.appendItem(new t("Output box","",this,n,function(){var t={left:i.parentSVG.snapToGrid(i.position.x),top:i.parentSVG.snapToGrid(i.position.y)};n.newOutput(t.left,t.top)})),this.appendConditionalItem("box","Remove this item",function(t){i.parentSVG.removeBox(t)}),this.appendConditionalItem("wire","Remove this wire",function(t){i.parentSVG.removeWireById(t)}),n.$svg.before(this.$el)},{appendItem:function(t){return this.$el.append(t.jQuery),t},appendConditionalItem:function(t,e,n){this.conditionalItems||(this.conditionalItems=[]),this.conditionalItems[this.conditionalItems.length]={itemClass:t,text:e,clickFunction:n}},resolveConditionalItems:function(e){for(var n=this,i=this,r=0;r<this.conditionalItems.length;++r)!function(r){e.hasClass(i.conditionalItems[r].itemClass)&&i.appendItem(new t(i.conditionalItems[r].text,"",i,i.parentSVG,function(){n.conditionalItems[r].clickFunction(e.attr("id"))})).addClass("conditional")}(r)},hideAllConditionalItems:function(){this.$el.children(".conditional").remove()},display:function(t,e,n){this.position={x:t,y:e},this.$el.css({display:"block",top:e+"px",left:t+"px"}),this.resolveConditionalItems(n)},hide:function(){this.$el.css({display:"none"}),this.hideAllConditionalItems()}},{})}();return{get default(){return n}}}(),$__src_47_es6_47_importExport_46_js__=function(){"use strict";var t=function(){function t(t){this.parentSVG=t}return $traceurRuntime.createClass(t,{get exportData(){return this.parentSVG.exportData},json:function(){var e=void 0!==arguments[0]?arguments[0]:t.style.compact;if(void 0!==arguments[1]&&arguments[1])return"data:application/json;charset=utf-8,"+encodeURIComponent(this.json(e));switch(e){case t.style.compact:return JSON.stringify(this.exportData);case t.style.pretty:return JSON.stringify(this.exportData,null,2)}}},{get style(){return{pretty:0,compact:1}}})}(),e=function(){return $traceurRuntime.createClass(function(t,e){t.importData(JSON.parse(e))},{},{})}();return{get exportNetwork(){return t},get importNetwok(){return e}}}(),$__src_47_es6_47_floatingMenu_46_js__=function(){"use strict";var t=$__src_47_es6_47_importExport_46_js__,e=t.exportNetwork,n=t.importNetwok,i=function(){return $traceurRuntime.createClass(function(t){this.$el=t?$("<"+t+">"):$("<div>")},{},{})}(),r=function(t){function e(t){$traceurRuntime.superConstructor(e).call(this),this.$el.addClass("helpWindowItem"),this.$el.html(t)}return $traceurRuntime.createClass(e,{},{},t)}(i),s=function(t){function e(){$traceurRuntime.superConstructor(e).call(this),this.$el.attr("id","help"),this.append(new r("<strong>main menu</strong>: right click")),this.append(new r("drag and drop to <strong>move elements</strong>")),this.append(new r("<strong>middle click</strong> to rotate elements")),this.append(new r("<strong>click <img src='img/gui/help.svg' class='helpicon' alt='help icon'></strong> to display documentation (in czech)"))}return $traceurRuntime.createClass(e,{append:function(t){this.$el.append(t.$el)}},{},t)}(i),o=function(t){function e(t,n,i,r){$traceurRuntime.superConstructor(e).call(this,r),this.$el.addClass("button"),this.$el.addClass(t),this.$el.append($("<img>").attr("src","img/gui/"+n+".svg").attr("alt",i).attr("title",i))}return $traceurRuntime.createClass(e,{},{},t)}(i),a=function(t){function i(t){$traceurRuntime.superConstructor(i).call(this);this.$el.attr("id","floatingMenu");var r,a=new o("import","import","Import a network","a");a.$el.on("click",function(){var e=$("<div>").addClass("importExport").addClass("import");e.append($("<textarea></textarea>").attr("id","importJSON")).append($("<a>").attr({href:"#",class:"upload"}).append($("<img>").attr("src","img/gui/import.svg")).append(" import from JSON").on("click",function(){var e=$("#importJSON").val();r.close(),new n(t,e)})),r=lity(e)}),this.append(a);var h=new o("export","export","Export this network","a");h.$el.on("click",function(){var n=new e(t),i=$("<div>").addClass("importExport").addClass("export");i.append($("<pre>").append($("<code>").text(n.json(e.style.pretty)))),i.append($("<a>").attr({href:n.json(e.style.pretty,!0),class:"download",download:"network.json"}).append($("<img>").attr("src","img/gui/export.svg")).append(" expanded JSON")),i.append($("<a>").attr({href:n.json(e.style.compact,!0),class:"download",download:"network.min.json"}).append($("<img>").attr("src","img/gui/export.svg")).append(" compact JSON")),lity(i)}),this.append(h);var u=new o("help","help","Display help","a");u.$el.on("mouseover",function(){$("#help").addClass("visible")}).on("mouseout",function(){$("#help").removeClass("visible")}),u.$el.attr({href:"./docs/user.html","data-lity":""}),this.append(u),t.$svg.after(this.$el),t.$svg.after((new s).$el)}return $traceurRuntime.createClass(i,{append:function(t){this.$el.append(t.$el)}},{},t)}(i);return{get default(){return a}}}(),$__src_47_es6_47_simulation_46_js__=function(){"use strict";var t=$__src_47_es6_47_logic_46_js__.default,e=function(){return $traceurRuntime.createClass(function(t,e,n){this.connectorId=t,this.state=e,this.whoCausedIt=n},{},{})}(),n=function(){return $traceurRuntime.createClass(function(t){this.parentSVG=t,this.predecessors=new Map,this.waves=new Map,this.wave=0,this.cycledConnectors=new Map,this.resolvedCycledConnectors=new Set},{run:function(){for(this.wave++;this.waves.has(this.wave);)this.step(),this.waves.delete(this.wave),this.wave++},step:function(){var e=!0,n=!1,i=void 0;try{for(var r=void 0,s=this.waves.get(this.wave)[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var o=r.value,a=o.connectorId,h=o.state,u=o.whoCausedIt;if(!this.resolvedCycledConnectors.has(a)){if(this.cycledConnectors.has(a)){var c=this.cycledConnectors.get(a);c.has(h)?(c.size>1&&(h=t.state.oscillating),this.resolvedCycledConnectors.add(a)):c.add(h),this.cycledConnectors.set(a,c)}this.whoCausedIt=a,u&&this.addPredecessor(a,u),!this.cycledConnectors.has(a)&&this.getAllPredecessors(a).has(a)&&this.cycledConnectors.set(a,new Set([h]));var l=this.parentSVG.getConnectorById(a);l&&l.setState(h)}}}catch(t){n=!0,i=t}finally{try{e||null==s.return||s.return()}finally{if(n)throw i}}this.whoCausedIt=void 0},addPredecessor:function(t,e){this.predecessors.has(t)||this.predecessors.set(t,new Set),this.predecessors.get(t).add(e)},getAllPredecessors:function(t){this.predecessors.has(t)||this.predecessors.set(t,new Set);var e=new Set;this.predecessors.get(t).forEach(e.add,e);for(var n=0,i=e.size;n<i;){var r=!0,s=!1,o=void 0;try{for(var a=void 0,h=e[Symbol.iterator]();!(r=(a=h.next()).done);r=!0){var u=a.value;this.predecessors.has(u)&&this.predecessors.get(u).forEach(e.add,e)}}catch(t){s=!0,o=t}finally{try{r||null==h.return||h.return()}finally{if(s)throw o}}n=i,i=e.size}return e},notifyChange:function(t,n){var i=this.wave+1;this.waves.has(i)||this.waves.set(i,[]),this.waves.get(i).push(new e(t,n,this.whoCausedIt))}},{})}();return{get default(){return n}}}(),$__src_47_es6_47_smallFunctions_46_js__=function(){"use strict";var t=function(){return $traceurRuntime.createClass(function(){},{},{deepCopy:function(t){return $.extend(!0,[],t)},addMouseScrollEventListener:function(t,e){var n=function(t){return(t=window.event||t).delta=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)),e(t),!1},i=document.querySelector(t);i.addEventListener?(i.addEventListener("mousewheel",n,!1),i.addEventListener("DOMMouseScroll",n,!1)):i.attachEvent("onmousewheel",n),i.addEventListener("mousewheel",function(t){console.log("event",t)},!1)}})}();return{get default(){return t}}}(),$__src_47_es6_47_canvas_46_js__=function(){"use strict";var t=$__src_47_es6_47_svgObjects_46_js__,e=$__src_47_es6_47_editorElements_46_js__,n=$__src_47_es6_47_logic_46_js__.default,i=$__src_47_es6_47_contextMenu_46_js__.default,r=$__src_47_es6_47_floatingMenu_46_js__.default,s=$__src_47_es6_47_simulation_46_js__.default,o=$__src_47_es6_47_smallFunctions_46_js__.default,a=function(){return $traceurRuntime.createClass(function(t,e,n,i){this.real={left:t,top:e,width:n,height:i},this.zoom=1,this.leftShift=0,this.topShift=0},{get width(){return this.real.width/this.zoom},get height(){return this.real.height/this.zoom},get left(){return this.real.left-this.leftShift/this.zoom+(this.real.width-this.width)/2},get top(){return this.real.top-this.topShift/this.zoom+(this.real.height-this.height)/2},get str(){return this.left+" "+this.top+" "+this.width+" "+this.height},transformX:function(t){return this.left+t/this.zoom},transformY:function(t){return this.top+t/this.zoom}},{})}(),h=function(){return $traceurRuntime.createClass(function(e,n){var h=this;this.$svg=$(e),this.gridSize=n,this.boxes=[],this.wires=[],this.simulationEnabled=!0,this.simulation=new s(this),this.$defs=$("<defs>"),this.$svg.prepend(this.$defs);var u=new t.Pattern("grid",this.gridSize,this.gridSize),c=(new t.PolylinePoints).append(new t.PolylinePoint(0,0)).append(new t.PolylinePoint(this.gridSize,0)).append(new t.PolylinePoint(this.gridSize,this.gridSize));u.addChild(new t.PolyLine(c,"#a3a4d2",2)),this.addPattern(u.get()),this.background=new t.Rectangle(0,0,this.width,this.height,"url(#grid)","none"),this.appendJQueryObject(this.background.get()),this.refresh(),this.$svg.attr("preserveAspectRatio","xMinYMin slice"),this.viewbox=new a(0,0,this.width,this.height),this.applyViewbox(),this.contextMenu=new i(this),this.floatingMenu=new r(this);var l;this.$svg.on("mousedown",function(t){void 0!==(l=h.getRealTarget(t.target))?l.onMouseDown(t):h.onMouseDown(t),h.hideContextMenu(),t.preventDefault()}).on("mousemove",function(t){void 0!==l?l.onMouseMove(t):h.onMouseMove(t),t.preventDefault()}).on("mouseup",function(t){void 0!==l?l.onMouseUp(t):h.onMouseUp(t),l=void 0,t.preventDefault()}).on("contextmenu",function(t){h.displayContextMenu(t.pageX,t.pageY,h.getRealJQueryTarget(t.target)),t.preventDefault()}),o.addMouseScrollEventListener(e,function(t){if(t.ctrlKey)switch(t.delta){case 1:h.zoom+=.1;break;case-1:h.zoom-=.1}t.preventDefault()})},{get width(){return this.$svg.width()},get height(){return this.$svg.height()},onMouseDown:function(t){t.ctrlKey&&(this.moveCanvas={left:t.pageX,top:t.pageY})},onMouseMove:function(t){if(this.moveCanvas){var e=t.pageX-this.moveCanvas.left,n=t.pageY-this.moveCanvas.top;this.viewbox.leftShift+=e,this.viewbox.topShift+=n,this.applyViewbox(),this.moveCanvas={left:t.pageX,top:t.pageY}}},onMouseUp:function(t){this.moveCanvas&&(this.moveCanvas=void 0)},applyViewbox:function(){this.background.addAttr({x:this.viewbox.left,y:this.viewbox.top,width:this.viewbox.width,height:this.viewbox.height}),this.$svg.attr("viewBox",this.viewbox.str)},get zoom(){return this.viewbox.zoom},set zoom(t){this.viewbox.zoom=t,this.applyViewbox()},get exportData(){this.exportWireIdMap=new Map,this.exportWireId=0;for(var t={boxes:[]},e=0;e<this.boxes.length;++e)t.boxes[e]=this.boxes[e].exportData;return t},importData:function(t){var n=this;this.simulationEnabled=!1;for(var i=new Map,r=0;r<t.boxes.length;++r){var s=void 0;switch(t.boxes[r].category){case"gate":s=this.newGate(t.boxes[r].name,0,0,!1);break;case"io":switch(t.boxes[r].name){case"input":s=this.newInput(0,0,t.boxes[r].isOn,!1);break;case"output":s=this.newOutput(0,0,!1);break;default:console.error("Unknown io box name '"+t.boxes[r].name+"'.")}break;default:console.error("Unknown box category '"+t.boxes[r].category+"'.")}if(s){for(var o=new e.Transform,a=0;a<t.boxes[r].transform.items.length;++a)switch(t.boxes[r].transform.items[a].name){case"translate":o.setTranslate(t.boxes[r].transform.items[a].args[0],t.boxes[r].transform.items[a].args[1]);break;case"rotate":o.setRotate(t.boxes[r].transform.items[a].args[0],t.boxes[r].transform.items[a].args[1],t.boxes[r].transform.items[a].args[2]);break;default:console.error("Unknown transform property '"+t.boxes[r].transform.items[a].name+"'.")}s.setTransform(o);for(var h=0;h<t.boxes[r].connections.length;++h){var u=t.boxes[r].connections[h].wireId,c={index:t.boxes[r].connections[h].index,type:t.boxes[r].connections[h].type,boxId:s.id};if(i.has(u)){var l=i.get(u);l[l.length]=c,i.set(u,l)}else i.set(u,[c])}}}this.refresh(),i.forEach(function(t){var e=[];if(t[0]&&t[1]){var i=!0,r=!1,s=void 0;try{for(var o=void 0,a=[0,1][Symbol.iterator]();!(i=(o=a.next()).done);i=!0){var h=o.value,u=n.getBoxById(t[h].boxId);e[h]=u.connectors[t[h].index].id}}catch(t){r=!0,s=t}finally{try{i||null==a.return||a.return()}finally{if(r)throw s}}}n.newWire(e[0],e[1],!0)}),this.refresh(),this.simulationEnabled=!0;var d=!0,f=!1,g=void 0;try{for(var p=void 0,v=this.boxes[Symbol.iterator]();!(d=(p=v.next()).done);d=!0){var m=p.value;m instanceof e.InputBox&&(m.on=!m.on,m.on=!m.on)}}catch(t){f=!0,g=t}finally{try{d||null==v.return||v.return()}finally{if(f)throw g}}},wireCreationHelper:function(t){this.firstConnectorId?(this.newWire(this.firstConnectorId,t),this.firstConnectorId=void 0):this.firstConnectorId=t},startNewSimulation:function(t,e){this.simulationEnabled&&(this.simulation=new s(this),this.simulation.notifyChange(t.id,e),this.simulation.run())},newGate:function(t,n,i){var r=void 0===arguments[3]||arguments[3];return this.newBox(n,i,new e.Gate(this,t,n,i),r)},newInput:function(t,n){var i=void 0!==arguments[2]&&arguments[2],r=void 0===arguments[3]||arguments[3];return this.newBox(t,n,new e.InputBox(this,i),r)},newOutput:function(t,n){var i=void 0===arguments[2]||arguments[2];return this.newBox(t,n,new e.OutputBox(this),i)},newBox:function(t,n,i){var r=void 0===arguments[3]||arguments[3],s=this.boxes.length;if(this.boxes[s]=i,t&&n){var o=new e.Transform;o.setTranslate(t,n),this.boxes[s].svgObj.addAttr({transform:o.get()})}return this.appendElement(this.boxes[s],r),this.boxes[s]},removeBox:function(t){for(var e=$("#"+t),n=-1,i=0;i<this.boxes.length;i++)if(this.boxes[i].svgObj.id===t){n=i;break}if(n>-1){for(var r=0;r<this.boxes[n].connectors.length;r++)this.removeWiresByConnectorId(this.boxes[n].connectors[r].svgObj.id);this.boxes.splice(n,1),e.remove()}else console.error("Trying to remove an nonexisting gate. (Gate id: "+t+")")},newWire:function(t,n){var i=void 0===arguments[2]||arguments[2],r=this;if(t===n)return!1;var s=[this.getConnectorById(t),this.getConnectorById(n)];s.forEach(function(t){t.isInputConnector&&r.removeWiresByConnectorId(t.id)});var o=this.wires.length;return this.wires[o]=new e.Wire(this,t,n,this.gridSize,i),s.forEach(function(t){t.addWireId(r.wires[o].svgObj.id)}),this.appendElement(this.wires[o],i),this.moveToBackById(this.wires[o].svgObj.id),i&&this.wires[o].updateWireState(),this.wires[o]},getWireById:function(t){var e=!0,n=!1,i=void 0;try{for(var r=void 0,s=this.wires[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var o=r.value;if(o.svgObj.id===t)return o}}catch(t){n=!0,i=t}finally{try{e||null==s.return||s.return()}finally{if(n)throw i}}return!1},getWiresByConnectorId:function(t){return this.getConnectorById(t).wireIds},removeWireById:function(t){for(var e=0;e<this.wires.length;++e)if(this.wires[e].svgObj.id===t){var n=this.wires[e].startConnector,i=this.wires[e].endConnector;n.removeWireIdAndUpdate(t),i.removeWireIdAndUpdate(t),this.wires[e].svgObj.$el.remove(),this.wires.splice(e,1);break}},removeWiresByConnectorId:function(t){var e=this,i=this.getConnectorById(t);i.wireIds.forEach(function(i){var r=e.getWireById(i),s=e.getConnectorById(r.fromId,r);s.svgObj.id===t&&(s=e.getConnectorById(r.toId,r)),s.wireIds.delete(i),$("#"+i).remove(),s.isInputConnector&&s.setState(n.state.unknown)}),i.wireIds.clear(),i.isInputConnector&&i.setState(n.state.unknown)},getBoxById:function(t){for(var e=0;e<this.boxes.length;e++)if(this.boxes[e].svgObj.id===t)return this.boxes[e];return!1},getBoxByConnectorId:function(t){for(var e=0;e<this.boxes.length;e++)if(void 0!==this.boxes[e].getConnectorById(t))return this.boxes[e];return!1},getConnectorById:function(t,e){if(void 0!==e){var n=e.startBox.getConnectorById(t);return n||(n=e.endBox.getConnectorById(t)),n}var i=!0,r=!1,s=void 0;try{for(var o=void 0,a=this.boxes[Symbol.iterator]();!(i=(o=a.next()).done);i=!0){var h=o.value.getConnectorById(t);if(h)return h}}catch(t){r=!0,s=t}finally{try{i||null==a.return||a.return()}finally{if(r)throw s}}return!1},getRealJQueryTarget:function(t){var e=$(t);if(!e.hasClass("connector")&&e.parents("g").length>0)for(e=e.parent();"G"!==e.prop("tagName")&&"g"!==e.prop("tagName");)e=e.parent();return e},getRealTarget:function(t){var e=$(t);if(e.hasClass("connector"))return this.getConnectorById(e.attr("id"));if(e.parents("g").length>0){for(var n=e.parent();"G"!==n.prop("tagName")&&"g"!==n.prop("tagName");)n=n.parent();return this.getBoxById(n.attr("id"))}return e.hasClass("wire")?this.getWireById(e.attr("id")):void 0},appendElement:function(t){var e=void 0===arguments[1]||arguments[1];this.appendJQueryObject(t.get(),e)},appendJQueryObject:function(t){var e=void 0===arguments[1]||arguments[1];this.$svg.append(t),e&&this.refresh()},addPattern:function(t){this.$defs.append(t),this.refresh()},refresh:function(){this.$svg.html(this.$svg.html()),console.log("SVG document has been reloaded.")},displayContextMenu:function(t,e,n){this.contextMenu.display(t,e,n)},hideContextMenu:function(){this.contextMenu.hide()},snapToGrid:function(t){return Math.round(t/this.gridSize)*this.gridSize},getNonRoutableNodes:function(){for(var t=new Set,e=0;e<this.boxes.length;++e){var n=$("#"+this.boxes[e].svgObj.id).children(".rect")[0],i=$(n).position();i.left=this.snapToGrid(i.left),i.top=this.snapToGrid(i.top);var r=!0,s=!1,o=void 0;try{for(var a=void 0,h=this.boxes[e].blockedNodes[Symbol.iterator]();!(r=(a=h.next()).done);r=!0){var u=a.value,c=i.left+u.x*this.gridSize,l=i.top+u.y*this.gridSize;t.add({x:c,y:l})}}catch(t){s=!0,o=t}finally{try{r||null==h.return||h.return()}finally{if(s)throw o}}}return t},moveToFrontById:function(t){this.$svg.append($("#"+t))},moveToBackById:function(t){$("#"+this.background.id).after($("#"+t))},getInconvenientNodes:function(t){for(var e=this,n=new Set,i=this,r=0;r<this.wires.length;++r)!function(r){if(void 0===t||t!==i.wires[r].svgObj.id){var s;i.wires[r].points.forEach(function(t){if(void 0===s)n.add({x:t.x,y:t.y});else if(s.x===t.x)for(var i=Math.min(s.y,t.y),r=Math.max(s.y,t.y);i<=r;)n.add({x:t.x,y:i}),i+=e.gridSize;else if(s.y===t.y)for(var o=Math.min(s.x,t.x),a=Math.max(s.x,t.x);o<=a;)n.add({x:o,y:t.y}),o+=e.gridSize;else console.error("getInconvenientNodes: line between two points is neither horizontal nor vertical");s={x:t.x,y:t.y}})}}(r);return n}},{snapToGrid:function(t,e){return Math.round(t/e)*e}})}();return{get default(){return h}}}(),$__src_47_es6_47_main_46_js__=function(){"use strict";var t=$__src_47_es6_47_canvas_46_js__.default;return $(function(){new t("svg#canvas",10)}),{}}();