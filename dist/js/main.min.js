!function i(s,a,u){function l(n,t){if(!a[n]){if(!s[n]){var e="function"==typeof require&&require;if(!t&&e)return e(n,!0);if(c)return c(n,!0);var o=new Error("Cannot find module '"+n+"'");throw o.code="MODULE_NOT_FOUND",o}var r=a[n]={exports:{}};s[n][0].call(r.exports,function(t){var e=s[n][1][t];return l(e||t)},r,r.exports,i,s,a,u)}return a[n].exports}for(var c="function"==typeof require&&require,t=0;t<u.length;t++)l(u[t]);return l}({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}}(),a=s(t("./svgObjects.js")),g=s(t("./editorElements.js")),i=r(t("./logic.js")),u=r(t("./contextMenu.js")),l=r(t("./floatingMenu.js")),c=r(t("./simulation.js")),h=r(t("./smallFunctions.js"));function r(t){return t&&t.__esModule?t:{default:t}}function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var d=function(){function r(t,e,n,o){f(this,r),this.real={left:t,top:e,width:n,height:o},this.zoom=1,this.leftShift=0,this.topShift=0}return o(r,[{key:"transformX",value:function(t){return this.left+t/this.zoom}},{key:"transformY",value:function(t){return this.top+t/this.zoom}},{key:"width",get:function(){return this.real.width/this.zoom}},{key:"height",get:function(){return this.real.height/this.zoom}},{key:"left",get:function(){return this.real.left-this.leftShift/this.zoom+(this.real.width-this.width)/2}},{key:"top",get:function(){return this.real.top-this.topShift/this.zoom+(this.real.height-this.height)/2}},{key:"str",get:function(){return this.left+" "+this.top+" "+this.width+" "+this.height}}]),r}(),p=function(){function s(t,e){var n=this;f(this,s),this.$svg=$(t),this.gridSize=e,this.boxes=[],this.wires=[],this.simulationEnabled=!0,this.simulation=new c.default(this),this.$defs=$("<defs>"),this.$svg.prepend(this.$defs);var o=new a.Pattern("grid",this.gridSize,this.gridSize),r=(new a.PolylinePoints).append(new a.PolylinePoint(0,0)).append(new a.PolylinePoint(this.gridSize,0)).append(new a.PolylinePoint(this.gridSize,this.gridSize));o.addChild(new a.PolyLine(r,"#a3a4d2",2)),this.addPattern(o.get()),this.background=new a.Rectangle(0,0,this.width,this.height,"url(#grid)","none"),this.appendJQueryObject(this.background.get()),this.refresh(),this.$svg.attr("preserveAspectRatio","xMinYMin slice"),this.viewbox=new d(0,0,this.width,this.height),this.applyViewbox(),this.contextMenu=new u.default(this),this.floatingMenu=new l.default(this);var i=void 0;this.$svg.on("mousedown",function(t){void 0!==(i=n.getRealTarget(t.target))?i.onMouseDown(t):n.onMouseDown(t),n.hideContextMenu(),t.preventDefault()}).on("mousemove",function(t){void 0!==i?i.onMouseMove(t):n.onMouseMove(t),t.preventDefault()}).on("mouseup",function(t){void 0!==i?i.onMouseUp(t):n.onMouseUp(t),i=void 0,t.preventDefault()}).on("contextmenu",function(t){n.displayContextMenu(t.pageX,t.pageY,n.getRealJQueryTarget(t.target)),t.preventDefault()}),h.default.addMouseScrollEventListener(t,function(t){if(t.ctrlKey)switch(t.delta){case 1:n.zoom+=.1;break;case-1:n.zoom-=.1}t.preventDefault()})}return o(s,[{key:"onMouseDown",value:function(t){t.ctrlKey&&(this.moveCanvas={left:t.pageX,top:t.pageY})}},{key:"onMouseMove",value:function(t){if(this.moveCanvas){var e=t.pageX-this.moveCanvas.left,n=t.pageY-this.moveCanvas.top;this.viewbox.leftShift+=e,this.viewbox.topShift+=n,this.applyViewbox(),this.moveCanvas={left:t.pageX,top:t.pageY}}}},{key:"onMouseUp",value:function(t){this.moveCanvas&&(this.moveCanvas=void 0)}},{key:"applyViewbox",value:function(){this.background.addAttr({x:this.viewbox.left,y:this.viewbox.top,width:this.viewbox.width,height:this.viewbox.height}),this.$svg.attr("viewBox",this.viewbox.str)}},{key:"importData",value:function(t){var s=this;this.simulationEnabled=!1;for(var e=new Map,n=0;n<t.boxes.length;++n){var o=void 0;switch(t.boxes[n].category){case"gate":o=this.newGate(t.boxes[n].name,0,0,!1);break;case"io":switch(t.boxes[n].name){case"input":o=this.newInput(0,0,t.boxes[n].isOn,!1);break;case"output":o=this.newOutput(0,0,!1);break;default:console.error("Unknown io box name '"+t.boxes[n].name+"'.")}break;default:console.error("Unknown box category '"+t.boxes[n].category+"'.")}if(o){for(var r=new g.Transform,i=0;i<t.boxes[n].transform.items.length;++i)switch(t.boxes[n].transform.items[i].name){case"translate":r.setTranslate(t.boxes[n].transform.items[i].args[0],t.boxes[n].transform.items[i].args[1]);break;case"rotate":r.setRotate(t.boxes[n].transform.items[i].args[0],t.boxes[n].transform.items[i].args[1],t.boxes[n].transform.items[i].args[2]);break;default:console.error("Unknown transform property '"+t.boxes[n].transform.items[i].name+"'.")}o.setTransform(r);for(var a=0;a<t.boxes[n].connections.length;++a){var u=t.boxes[n].connections[a].wireId,l={index:t.boxes[n].connections[a].index,type:t.boxes[n].connections[a].type,boxId:o.id};if(e.has(u)){var c=e.get(u);c[c.length]=l,e.set(u,c)}else e.set(u,[l])}}}this.refresh(),e.forEach(function(t){var e=[];if(t[0]&&t[1])for(var n=[0,1],o=0;o<n.length;o++){var r=n[o],i=s.getBoxById(t[r].boxId);e[r]=i.connectors[t[r].index].id}s.newWire(e[0],e[1],!0)}),this.refresh();var h=this.simulationEnabled=!0,f=!1,d=void 0;try{for(var p,v=this.boxes[Symbol.iterator]();!(h=(p=v.next()).done);h=!0){var y=p.value;y instanceof g.InputBox&&(y.on=!y.on,y.on=!y.on)}}catch(t){f=!0,d=t}finally{try{!h&&v.return&&v.return()}finally{if(f)throw d}}}},{key:"wireCreationHelper",value:function(t){this.firstConnectorId?(this.newWire(this.firstConnectorId,t),this.firstConnectorId=void 0):this.firstConnectorId=t}},{key:"startNewSimulation",value:function(t,e){this.simulationEnabled&&(this.simulation=new c.default(this),this.simulation.notifyChange(t.id,e),this.simulation.run())}},{key:"newGate",value:function(t,e,n){var o=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];return this.newBox(e,n,new g.Gate(this,t,e,n),o)}},{key:"newInput",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],o=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];return this.newBox(t,e,new g.InputBox(this,n),o)}},{key:"newOutput",value:function(t,e){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];return this.newBox(t,e,new g.OutputBox(this),n)}},{key:"newBox",value:function(t,e,n){var o=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],r=this.boxes.length;if(this.boxes[r]=n,t&&e){var i=new g.Transform;i.setTranslate(t,e),this.boxes[r].svgObj.addAttr({transform:i.get()})}return this.appendElement(this.boxes[r],o),this.boxes[r]}},{key:"removeBox",value:function(t){for(var e=$("#"+t),n=-1,o=0;o<this.boxes.length;o++)if(this.boxes[o].svgObj.id===t){n=o;break}if(-1<n){for(var r=0;r<this.boxes[n].connectors.length;r++)this.removeWiresByConnectorId(this.boxes[n].connectors[r].svgObj.id);this.boxes.splice(n,1),e.remove()}else console.error("Trying to remove an nonexisting gate. (Gate id: "+t+")")}},{key:"newWire",value:function(t,e){var n=this,o=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if(t===e)return!1;var r=[this.getConnectorById(t),this.getConnectorById(e)];r.forEach(function(t){t.isInputConnector&&n.removeWiresByConnectorId(t.id)});var i=this.wires.length;return this.wires[i]=new g.Wire(this,t,e,this.gridSize,o),r.forEach(function(t){t.addWireId(n.wires[i].svgObj.id)}),this.appendElement(this.wires[i],o),this.moveToBackById(this.wires[i].svgObj.id),o&&this.wires[i].updateWireState(),this.wires[i]}},{key:"getWireById",value:function(t){var e=!0,n=!1,o=void 0;try{for(var r,i=this.wires[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var s=r.value;if(s.svgObj.id===t)return s}}catch(t){n=!0,o=t}finally{try{!e&&i.return&&i.return()}finally{if(n)throw o}}return!1}},{key:"getWiresByConnectorId",value:function(t){return this.getConnectorById(t).wireIds}},{key:"removeWireById",value:function(t){for(var e=0;e<this.wires.length;++e)if(this.wires[e].svgObj.id===t){var n=this.wires[e].startConnector,o=this.wires[e].endConnector;n.removeWireIdAndUpdate(t),o.removeWireIdAndUpdate(t),this.wires[e].svgObj.$el.remove(),this.wires.splice(e,1);break}}},{key:"removeWiresByConnectorId",value:function(o){var r=this,t=this.getConnectorById(o);t.wireIds.forEach(function(t){var e=r.getWireById(t),n=r.getConnectorById(e.fromId,e);n.svgObj.id===o&&(n=r.getConnectorById(e.toId,e)),n.wireIds.delete(t),$("#"+t).remove(),n.isInputConnector&&n.setState(i.default.state.unknown)}),t.wireIds.clear(),t.isInputConnector&&t.setState(i.default.state.unknown)}},{key:"getBoxById",value:function(t){for(var e=0;e<this.boxes.length;e++)if(this.boxes[e].svgObj.id===t)return this.boxes[e];return!1}},{key:"getBoxByConnectorId",value:function(t){for(var e=0;e<this.boxes.length;e++)if(void 0!==this.boxes[e].getConnectorById(t))return this.boxes[e];return!1}},{key:"getConnectorById",value:function(t,e){if(void 0!==e){var n=e.startBox.getConnectorById(t);return n||(n=e.endBox.getConnectorById(t)),n}var o=!0,r=!1,i=void 0;try{for(var s,a=this.boxes[Symbol.iterator]();!(o=(s=a.next()).done);o=!0){var u=s.value.getConnectorById(t);if(u)return u}}catch(t){r=!0,i=t}finally{try{!o&&a.return&&a.return()}finally{if(r)throw i}}return!1}},{key:"getRealJQueryTarget",value:function(t){var e=$(t);if(!e.hasClass("connector")&&0<e.parents("g").length)for(e=e.parent();"G"!==e.prop("tagName")&&"g"!==e.prop("tagName");)e=e.parent();return e}},{key:"getRealTarget",value:function(t){var e=$(t);if(e.hasClass("connector"))return this.getConnectorById(e.attr("id"));if(0<e.parents("g").length){for(var n=e.parent();"G"!==n.prop("tagName")&&"g"!==n.prop("tagName");)n=n.parent();return this.getBoxById(n.attr("id"))}return e.hasClass("wire")?this.getWireById(e.attr("id")):void 0}},{key:"appendElement",value:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.appendJQueryObject(t.get(),e)}},{key:"appendJQueryObject",value:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.$svg.append(t),e&&this.refresh()}},{key:"addPattern",value:function(t){this.$defs.append(t),this.refresh()}},{key:"refresh",value:function(){this.$svg.html(this.$svg.html()),console.log("SVG document has been reloaded.")}},{key:"displayContextMenu",value:function(t,e,n){this.contextMenu.display(t,e,n)}},{key:"hideContextMenu",value:function(){this.contextMenu.hide()}},{key:"snapToGrid",value:function(t){return Math.round(t/this.gridSize)*this.gridSize}},{key:"getNonRoutableNodes",value:function(){for(var t=new Set,e=0;e<this.boxes.length;++e){var n=$("#"+this.boxes[e].svgObj.id).children(".rect")[0],o=$(n).position();o.left=this.snapToGrid(o.left),o.top=this.snapToGrid(o.top);var r=!0,i=!1,s=void 0;try{for(var a,u=this.boxes[e].blockedNodes[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var l=a.value,c=o.left+l.x*this.gridSize,h=o.top+l.y*this.gridSize;t.add({x:c,y:h})}}catch(t){i=!0,s=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw s}}}return t}},{key:"moveToFrontById",value:function(t){this.$svg.append($("#"+t))}},{key:"moveToBackById",value:function(t){$("#"+this.background.id).after($("#"+t))}},{key:"getInconvenientNodes",value:function(t){for(var s=this,a=new Set,e=0;e<this.wires.length;++e)void 0!==t&&t===this.wires[e].svgObj.id||function(){var i=void 0;s.wires[e].points.forEach(function(t){if(void 0===i)a.add({x:t.x,y:t.y});else if(i.x===t.x)for(var e=Math.min(i.y,t.y),n=Math.max(i.y,t.y);e<=n;)a.add({x:t.x,y:e}),e+=s.gridSize;else if(i.y===t.y)for(var o=Math.min(i.x,t.x),r=Math.max(i.x,t.x);o<=r;)a.add({x:o,y:t.y}),o+=s.gridSize;else console.error("getInconvenientNodes: line between two points is neither horizontal nor vertical");i={x:t.x,y:t.y}})}();return a}},{key:"width",get:function(){return this.$svg.width()}},{key:"height",get:function(){return this.$svg.height()}},{key:"zoom",get:function(){return this.viewbox.zoom},set:function(t){this.viewbox.zoom=t,this.applyViewbox()}},{key:"exportData",get:function(){this.exportWireIdMap=new Map;for(var t={boxes:[]},e=this.exportWireId=0;e<this.boxes.length;++e)t.boxes[e]=this.boxes[e].exportData;return t}}],[{key:"snapToGrid",value:function(t,e){return Math.round(t/e)*e}}]),s}();n.default=p},{"./contextMenu.js":2,"./editorElements.js":3,"./floatingMenu.js":4,"./logic.js":6,"./simulation.js":8,"./smallFunctions.js":9,"./svgObjects.js":11}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}}();function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function i(t,e,n,o,r){s(this,i),this.name=t,this.type=e,this.contextMenu=n,this.parentSVG=o,this.$el=$("<li>"),$(this.$el).text(t).attr("type",e),r&&$(this.$el).click(function(t){r(t),n.hide()})}return o(i,[{key:"addClass",value:function(t){return this.$el.addClass(t),this}},{key:"appendItem",value:function(t){return this.subList||(this.subList=$("<ul>"),this.$el.append(this.subList)),this.subList.append(t.jQuery),t}},{key:"jQuery",get:function(){return this.$el}}]),i}(),u=function(t){function e(n,o,r){return s(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,n,o,r,function(t){var e={left:Math.round(o.position.x/r.gridSize)*r.gridSize,top:Math.round(o.position.y/r.gridSize)*r.gridSize};r.newGate(n,e.left,e.top)}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),e}(),r=function(){function i(e){var n=this;s(this,i),this.parentSVG=e;var t=["not","and","or","nand","nor","xor","xnor"];this.position={x:0,y:0},this.$el=$("<ul>"),this.$el.attr("id","contextMenu");for(var o=new a("New gate","",this,e),r=0;r<t.length;++r)o.appendItem(new u(t[r],this,e));this.appendItem(o),this.appendItem(new a("Input box","",this,e,function(){var t={left:n.parentSVG.snapToGrid(n.position.x),top:n.parentSVG.snapToGrid(n.position.y)};e.newInput(t.left,t.top)})),this.appendItem(new a("Output box","",this,e,function(){var t={left:n.parentSVG.snapToGrid(n.position.x),top:n.parentSVG.snapToGrid(n.position.y)};e.newOutput(t.left,t.top)})),this.appendConditionalItem("box","Remove this item",function(t){n.parentSVG.removeBox(t)}),this.appendConditionalItem("wire","Remove this wire",function(t){n.parentSVG.removeWireById(t)}),e.$svg.before(this.$el)}return o(i,[{key:"appendItem",value:function(t){return this.$el.append(t.jQuery),t}},{key:"appendConditionalItem",value:function(t,e,n){this.conditionalItems||(this.conditionalItems=[]),this.conditionalItems[this.conditionalItems.length]={itemClass:t,text:e,clickFunction:n}}},{key:"resolveConditionalItems",value:function(e){for(var n=this,t=function(t){e.hasClass(n.conditionalItems[t].itemClass)&&n.appendItem(new a(n.conditionalItems[t].text,"",n,n.parentSVG,function(){n.conditionalItems[t].clickFunction(e.attr("id"))})).addClass("conditional")},o=0;o<this.conditionalItems.length;++o)t(o)}},{key:"hideAllConditionalItems",value:function(){this.$el.children(".conditional").remove()}},{key:"display",value:function(t,e,n){this.position={x:t,y:e},this.$el.css({display:"block",top:e+"px",left:t+"px"}),this.resolveConditionalItems(n)}},{key:"hide",value:function(){this.$el.css({display:"none"}),this.hideAllConditionalItems()}}]),i}();n.default=r},{}],3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Wire=n.Gate=n.OutputBox=n.InputBox=n.OutputConnector=n.InputConnector=n.Transform=void 0;var o,u=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(o):void 0},r=function(){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}}(),O=s(t("./svgObjects.js")),C=s(t("./structuresAndClasses.js")),i=t("./logic.js"),f=(o=i)&&o.__esModule?o:{default:o};function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function d(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a={on:"stateOn",off:"stateOff",unknown:"stateUnknown",oscillating:"stateOscillating"},c=function(){function e(t){p(this,e),void 0!==t&&(this.name=t.replace(/^[ ]*([^(]+).*/,"$1"),this.args=t.replace(/^[^(]+\((.*)\)/,"$1").split(" "))}return r(e,[{key:"setName",value:function(t){this.name=t}},{key:"setArguments",value:function(t){this.args=t}},{key:"get",value:function(){return this.name+"("+this.args.join(" ")+")"}}]),e}(),h=n.Transform=function(){function o(t){if(p(this,o),this.items=[],void 0!==t)for(var e=t.split(")"),n=0;n<e.length;n++)e[n]&&this.items.push(new c(e[n]+")"))}return r(o,[{key:"getIndex",value:function(t){for(var e=0;e<this.items.length;e++)if(t===this.items[e].name)return e;return-1}},{key:"getTranslate",value:function(){var t=this.getArguments(this.getIndex("translate"));return{x:t[0],y:t[1]}}},{key:"getRotate",value:function(){var t=this.getArguments(this.getIndex("rotate"));return{deg:t[0],centreX:t[1],centreY:t[2]}}},{key:"setTranslate",value:function(t,e){this.setParameter("translate",[t,e])}},{key:"setRotate",value:function(t,e,n){this.setParameter("rotate",[t,e,n])}},{key:"rotateRight",value:function(t,e){if(-1===this.getIndex("rotate"))this.setRotate(90,t,e);else{var n=(parseInt(this.getRotate().deg)+90)%360;if(180===n){var o=t;t=e,e=o}this.setRotate(n,t,e)}}},{key:"get",value:function(){for(var t="",e=0;e<this.items.length;e++)0!==e&&(t+=" "),t+=this.items[e].get();return t}},{key:"getArguments",value:function(t){return this.items[t].args}},{key:"setParameter",value:function(t,e){var n=this.getIndex(t);-1===n&&(n=this.items.length,this.items[n]=new c,this.items[n].setName(t)),this.items[n].setArguments(e)}}]),o}(),v=function(){function e(t){p(this,e),t||console.error("Parent SVG element has not been defined."),this.parentSVG=t,this.svgObj=void 0}return r(e,[{key:"onMouseDown",value:function(){}},{key:"onMouseUp",value:function(){}},{key:"onMouseMove",value:function(){}},{key:"id",get:function(){return this.svgObj.id}},{key:"exportData",get:function(){console.error("'json' getter has not been defined for this element",this)}}]),e}(),y=function(t){function i(t,e,n,o){p(this,i);var r=d(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return r.gridSize=e,r.connectorSize=e,r.connectorOffset=r.connectorSize/2,r.svgObj=new O.Rectangle(n*r.gridSize-r.connectorOffset,o*r.gridSize-r.connectorOffset,r.connectorSize,r.connectorSize,"none","black"),r.svgObj.$el.addClass("connector"),r.stateAttr=!1,r.isInputConnector=!1,r.stateAttr=f.default.state.unknown,r.svgObj.addClass(a.unknown),r.wireIds=new Set,r}return l(i,v),r(i,[{key:"addWireId",value:function(t){this.wireIds.add(t)}},{key:"removeWireId",value:function(t){this.wireIds.delete(t)}},{key:"removeWireIdAndUpdate",value:function(t){this.removeWireId(t)}},{key:"setState",value:function(t,e){switch(this.svgObj.removeClasses(a.on,a.off,a.unknown,a.oscillating),t){case f.default.state.unknown:this.svgObj.addClass(a.unknown);break;case f.default.state.on:this.svgObj.addClass(a.on);break;case f.default.state.off:this.svgObj.addClass(a.off);break;case f.default.state.oscillating:this.svgObj.addClass(a.oscillating)}this.stateAttr=t}},{key:"get",value:function(){return this.svgObj}},{key:"onMouseUp",value:function(){this.parentSVG.wireCreationHelper(this.svgObj.id)}},{key:"isOutputConnector",get:function(){return!this.isInputConnector}},{key:"state",get:function(){return this.stateAttr}}],[{key:"type",get:function(){return{inputConnector:0,outputConnector:1}}}]),i}(),g=n.InputConnector=function(t){function i(t,e,n,o){p(this,i);var r=d(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e,n,o));return r.type=y.type.inputConnector,r.isInputConnector=!0,r}return l(i,y),r(i,[{key:"setState",value:function(t){u(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"setState",this).call(this,t),this.parentSVG.getBoxByConnectorId(this.svgObj.id).refreshState()}},{key:"removeWireIdAndUpdate",value:function(t){u(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"removeWireIdAndUpdate",this).call(this,t),this.setState(f.default.state.unknown)}},{key:"state",get:function(){return u(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"state",this)}}]),i}(),m=n.OutputConnector=function(t){function a(t,e,n,o){p(this,a);var r=d(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t,e,n,o));return r.isOutput=!0,r.type=y.type.outputConnector,r}return l(a,y),r(a,[{key:"setState",value:function(t){u(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"setState",this).call(this,t);var e=!0,n=!1,o=void 0;try{for(var r,i=this.wireIds[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var s=r.value;this.parentSVG.getWireById(s).setState(t)}}catch(t){n=!0,o=t}finally{try{!e&&i.return&&i.return()}finally{if(n)throw o}}}},{key:"state",get:function(){return u(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"state",this)}}]),a}(),b=function(t){function a(t,e,n,o,r){p(this,a);var i=d(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t));i.name=e,i.category=n,i.gridSize=i.parentSVG.gridSize,i.url="img/"+i.category+"/"+i.name+".svg",i.connectors=[],i.svgObj=new O.Group,i.width=o*i.gridSize,i.height=r*i.gridSize,i.gridWidth=o,i.gridHeight=r;var s=new O.Rectangle(0,0,i.width,i.height,"none","none");return s.$el.addClass("rect"),i.svgObj.addChild(s),i.image=new O.SvgImage(0,0,i.width,i.height,i.url),i.svgObj.addChild(i.image),i.svgObj.draggable(!0),i.svgObj.rotatable(!0),i.svgObj.addAttr({type:n}),i.svgObj.$el.addClass("box"),i.svgObj.$el.addClass(n),i.generateBlockNodes(),i}return l(a,v),r(a,[{key:"generateBlockNodes",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;this.blockedNodes=new Set;for(var r=o;r<=this.gridWidth-e;r++)for(var i=t;i<=this.gridHeight-n;i++)this.blockedNodes.add({x:r,y:i});for(var s=arguments.length,a=Array(4<s?s-4:0),u=4;u<s;u++)a[u-4]=arguments[u];var l=!0,c=!1,h=void 0;try{for(var f,d=a[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var p=f.value;this.blockedNodes.add(p)}}catch(t){c=!0,h=t}finally{try{!l&&d.return&&d.return()}finally{if(c)throw h}}}},{key:"refreshState",value:function(){console.warn("Calling the virtual function refreshState has no effect.")}},{key:"changeImage",value:function(t){t=void 0===t||""===t?"":"-"+t,this.url="img/"+this.category+"/"+this.name+t+".svg",this.image.changeUrl(this.url)}},{key:"get",value:function(){return this.svgObj.get()}},{key:"removeBlockedNode",value:function(t,e){var n=!0,o=!1,r=void 0;try{for(var i,s=this.blockedNodes[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var a=i.value;if(a.x===t&&a.y===e){this.blockedNodes.delete(a);break}}}catch(t){o=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw r}}}},{key:"rotateBlockedNodesRight",value:function(){var e=this;if(void 0!==this.rotation&&4!==this.rotation||(this.rotation=0),this.rotation++,1===this.rotation||3===this.rotation){var n=new Set;this.blockedNodes.forEach(function(t){n.add({x:Math.abs(t.y-e.gridHeight),y:t.x})}),this.blockedNodes=n}else if(2===this.rotation||4===this.rotation){var o=new Set;this.blockedNodes.forEach(function(t){o.add({x:Math.abs(t.y-e.gridWidth),y:t.x})}),this.blockedNodes=o}}},{key:"addConnector",value:function(t,e,n){var o=this.connectors.length;n===y.type.inputConnector?this.connectors[o]=new g(this.parentSVG,this.gridSize,t,e):this.connectors[o]=new m(this.parentSVG,this.gridSize,t,e),this.svgObj.addChild(this.connectors[o].get()),this.removeBlockedNode(t,e)}},{key:"getConnectorById",value:function(t){for(var e=0;e<this.connectors.length;e++)if(this.connectors[e].id===t)return this.connectors[e]}},{key:"getTransform",value:function(){var t=void 0;return this.svgObj.$el.attr("transform")?t=new h(this.svgObj.$el.attr("transform")):((t=new h).setTranslate(0,0),this.svgObj.addAttr({transform:t.get()})),t}},{key:"setTransform",value:function(t){this.svgObj.addAttr({transform:t.get()})}},{key:"transformEvent",value:function(t){return t.pageX=this.parentSVG.viewbox.transformX(t.pageX),t.pageY=this.parentSVG.viewbox.transformY(t.pageY),t}},{key:"onMouseDown",value:function(t){this.mouseLeft=!1,1===t.which&&(this.mouseLeft=!0,this.onMouseDownLeft(t),this.parentSVG.moveToFrontById(this.svgObj.id))}},{key:"onMouseDownLeft",value:function(t){this.mouseMoved=!1;var e=this.getTransform().getTranslate(),n=this.transformEvent(t),o=n.pageX,r=n.pageY;this.offset={x:o-e.x,y:r-e.y}}},{key:"onMouseMove",value:function(t){if(this.mouseLeft){this.mouseMoved=!0;var e=this.transformEvent(t),n=e.pageX,o=e.pageY,r=n-this.offset.x,i=o-this.offset.y,s=this.getTransform();s.setTranslate(r,i),this.setTransform(s),this.updateWires(!0)}}},{key:"onMouseUp",value:function(t){1===t.which?this.mouseMoved?this.onDrop(t):this.onClick():2===t.which&&this.onClickMiddle()}},{key:"onDrop",value:function(t){var e=this.transformEvent(t),n=e.pageX,o=e.pageY,r=n-this.offset.x,i=o-this.offset.y;r=this.parentSVG.snapToGrid(r),i=this.parentSVG.snapToGrid(i);var s=this.getTransform();s.setTranslate(r,i),this.setTransform(s),this.updateWires()}},{key:"onClick",value:function(){}},{key:"onClickMiddle",value:function(){var t=this.getTransform(),e=this.svgObj.$el[0].getBoundingClientRect(),n=Math.round(e.width/2),o=Math.round(e.height/2);n-=n%this.gridSize,o-=o%this.gridSize,t.rotateRight(n,o),this.svgObj.addAttr({transform:t.get()}),this.rotateBlockedNodesRight(),this.updateWires()}},{key:"updateWires",value:function(){var n=this,o=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.connectors.forEach(function(t){t.wireIds.forEach(function(t){var e=n.parentSVG.getWireById(t);o?e.temporaryWire():e.routeWire()})})}},{key:"inputConnectors",get:function(){return this.connectors.filter(function(t){return t.isInputConnector})}},{key:"outputConnectors",get:function(){return this.connectors.filter(function(t){return t.isOutputConnector})}},{key:"exportData",get:function(){var t=[],e=0,n=!0,o=!1,r=void 0;try{for(var i,s=this.connectors[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var a=i.value,u=!0,l=!1,c=void 0;try{for(var h,f=a.wireIds[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var d=h.value,p=void 0;this.parentSVG.exportWireIdMap.has(d)?p=this.parentSVG.exportWireIdMap.get(d):(this.parentSVG.exportWireIdMap.set(d,this.parentSVG.exportWireId),p=this.parentSVG.exportWireId,this.parentSVG.exportWireId++),t[t.length]={index:e,type:a.type,wireId:p}}}catch(t){l=!0,c=t}finally{try{!u&&f.return&&f.return()}finally{if(l)throw c}}e++}}catch(t){o=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw r}}return{name:this.name,category:this.category,transform:this.getTransform(),connections:t}}}]),a}();n.InputBox=function(t){function o(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];p(this,o);var n=d(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,"input","io",7,4));return n.addConnector(7,2,y.type.outputConnector),n.on=e,n}return l(o,b),r(o,[{key:"generateBlockNodes",value:function(){u(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"generateBlockNodes",this).call(this,0,1,1,0)}},{key:"refreshState",value:function(){this.parentSVG.startNewSimulation(this.connectors[0],this.connectors[0].state)}},{key:"onClick",value:function(){this.on=!this.on}},{key:"exportData",get:function(){var t=u(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"exportData",this);return t.isOn=this.isOn,t}},{key:"on",set:function(t){t?(this.changeImage("on"),this.connectors[0].setState(f.default.state.on)):(this.changeImage(),this.connectors[0].setState(f.default.state.off)),this.refreshState(),this.isOn=t},get:function(){return this.isOn}}]),o}(),n.OutputBox=function(t){function n(t){p(this,n);var e=d(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,"output","io",5,4));return e.addConnector(0,2,y.type.inputConnector),e}return l(n,b),r(n,[{key:"refreshState",value:function(){this.setState(this.connectors[0].state)}},{key:"setState",value:function(t){switch(t){case f.default.state.on:this.changeImage("on");break;case f.default.state.off:this.changeImage("off");break;case f.default.state.unknown:this.changeImage();break;case f.default.state.oscillating:this.changeImage("osc")}}},{key:"generateBlockNodes",value:function(){u(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"generateBlockNodes",this).call(this,0,0,0,1)}}]),n}(),n.Gate=function(t){function o(t,e){p(this,o);var n=d(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,e,"gate",9,4));return n.addConnector(9,2,y.type.outputConnector),"not"===n.name?n.addConnector(0,2,y.type.inputConnector):(n.addConnector(0,1,y.type.inputConnector),n.addConnector(0,3,y.type.inputConnector),n.generateBlockNodes({x:0,y:2})),n.refreshState(),n}return l(o,b),r(o,[{key:"generateBlockNodes",value:function(t){void 0!==t?u(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"generateBlockNodes",this).call(this,0,1,0,1,t):u(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"generateBlockNodes",this).call(this,0,1,0,1)}},{key:"refreshState",value:function(){var t=f.default.state.unknown;switch(this.name){case"and":t=f.default.and(this.connectors[1].state,this.connectors[2].state);break;case"nand":t=f.default.nand(this.connectors[1].state,this.connectors[2].state);break;case"nor":t=f.default.nor(this.connectors[1].state,this.connectors[2].state);break;case"not":t=f.default.not(this.connectors[1].state);break;case"or":t=f.default.or(this.connectors[1].state,this.connectors[2].state);break;case"xnor":t=f.default.xnor(this.connectors[1].state,this.connectors[2].state);break;case"xor":t=f.default.xor(this.connectors[1].state,this.connectors[2].state)}this.parentSVG.simulation.notifyChange(this.connectors[0].id,t)}}]),o}(),n.Wire=function(t){function x(t,e,n,o){var r=!(4<arguments.length&&void 0!==arguments[4])||arguments[4];p(this,x);var i=d(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,t));i.gridSize=o,i.fromId=e,i.toId=n,i.startBox=i.parentSVG.getBoxByConnectorId(e),i.endBox=i.parentSVG.getBoxByConnectorId(n),i.boxes=[i.startBox,i.endBox],i.startConnector=i.parentSVG.getConnectorById(e),i.endConnector=i.parentSVG.getConnectorById(n),i.connectors=[i.startConnector,i.endConnector],i.routeWire(!0,r),i.stateAttr=f.default.state.unknown;var s=!0,a=!1,u=void 0;try{for(var l,c=i.connectors[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var h=l.value;h.isOutput&&i.setState(h.state)}}catch(t){a=!0,u=t}finally{try{!s&&c.return&&c.return()}finally{if(a)throw u}}return i.svgObj.$el.addClass("wire"),i}return l(x,v),r(x,[{key:"setState",value:function(t){switch(this.svgObj.removeClasses(a.on,a.off,a.unknown,a.oscillating),t){case f.default.state.unknown:this.svgObj.addClass(a.unknown);break;case f.default.state.on:this.svgObj.addClass(a.on);break;case f.default.state.off:this.svgObj.addClass(a.off);break;case f.default.state.oscillating:this.svgObj.addClass(a.oscillating)}this.startConnector.isInputConnector&&this.startConnector.setState(t),this.endConnector.isInputConnector&&this.endConnector.setState(t),this.stateAttr=t}},{key:"updateWireState",value:function(){var t=!0,e=!1,n=void 0;try{for(var o,r=this.boxes[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){o.value.refreshState()}}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}}},{key:"get",value:function(){return this.svgObj.get()}},{key:"getTemporaryWirePoints",value:function(){var t=new O.PolylinePoints;return t.append(new O.PolylinePoint(this.wireStart.x,this.wireStart.y)),t.append(new O.PolylinePoint(this.wireEnd.x,this.wireEnd.y)),t}},{key:"temporaryWire",value:function(){this.wireStart=this.getCoordinates(this.startConnector,!1),this.wireEnd=this.getCoordinates(this.endConnector,!1),this.setWirePath(this.getTemporaryWirePoints())}},{key:"routeWire",value:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.wireStart=this.getCoordinates(this.startConnector,t),this.wireEnd=this.getCoordinates(this.endConnector,t),this.points=this.aStar({x:this.wireStart.x/this.gridSize,y:this.wireStart.y/this.gridSize},{x:this.wireEnd.x/this.gridSize,y:this.wireEnd.y/this.gridSize}),this.setWirePath(this.points),e&&this.updateWireState()}},{key:"setWirePath",value:function(t){void 0!==this.svgObj?this.svgObj.updatePoints(t):this.svgObj=new O.PolyLine(t,"#8b8b8b",2),this.svgObj.removeClasses(a.on,a.off,a.unknown,a.oscillating),this.svgObj.addClass(a.unknown),this.svgObj.addAttr({fromId:this.fromId,toId:this.toId})}},{key:"aStar",value:function(t,e){var n=new Set,o=new Set;o.add(t);var r=new Map,i=new C.MapWithDefaultValue(1/0);i.set(t,0);var s=new C.MapWithDefaultValue(1/0);s.set(t,x.manhattanDistance(t,e));var a=this.parentSVG.getNonRoutableNodes(),u=void 0;for(u=void 0===this.svgObj?this.parentSVG.getInconvenientNodes():this.parentSVG.getInconvenientNodes(this.svgObj.id);0<o.size;){var l=void 0,c=void 0,h=!0,f=!1,d=void 0;try{for(var p,v=o[Symbol.iterator]();!(h=(p=v.next()).done);h=!0){var y=p.value;(!l||s.get(y)<c)&&(l=y,c=s.get(l))}}catch(t){f=!0,d=t}finally{try{!h&&v.return&&v.return()}finally{if(f)throw d}}if(O.PolylinePoint.equals(l,e))return this.reconstructPath(r,l);o.delete(l),n.add(l);for(var g=0;g<4;g++)for(var m=x.movePoint(l,g),b=0;b<50&&!x.setHasThisPoint(a,this.scalePointToGrid(m));b++)if(!n.has(m)){o.has(m).y||o.add(m);var w=1;0!==b&&(w=2);var k=i.get(l)+w;if(x.setHasThisPoint(u,this.scalePointToGrid(m))&&(k+=1),!(k>=i.get(m))){if(r.set(m,l),i.set(m,k),s.set(m,k+x.manhattanDistance(m,e)),x.setHasThisPoint(u,this.scalePointToGrid(m)))break;m=x.movePoint(m,g)}}if(5e4<o.size)break}return this.getTemporaryWirePoints()}},{key:"scalePointToGrid",value:function(t){return{x:t.x*this.gridSize,y:t.y*this.gridSize}}},{key:"reconstructPath",value:function(t,e){var n=new O.PolylinePoints;for(n.append(new O.PolylinePoint(e.x*this.gridSize,e.y*this.gridSize));t.has(e);)e=t.get(e),n.append(new O.PolylinePoint(e.x*this.gridSize,e.y*this.gridSize));return n}},{key:"getCoordinates",value:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=(t.svgObj.id,t.svgObj.$el),o=n.position();o.left=this.parentSVG.viewbox.transformX(o.left),o.top=this.parentSVG.viewbox.transformY(o.top);var r=n.attr("width"),i=n.attr("height"),s=o.left+r/2,a=o.top+i/2;return e&&(s=this.parentSVG.snapToGrid(s),a=this.parentSVG.snapToGrid(a)),{x:s,y:a}}},{key:"exportData",get:function(){return{fromId:this.fromId,toId:this.toId}}},{key:"state",get:function(){return this.stateAttr}}],[{key:"movePoint",value:function(t,e){switch(e){case 0:return{x:t.x,y:t.y-1};case 1:return{x:t.x+1,y:t.y};case 2:return{x:t.x,y:t.y+1};case 3:return{x:t.x-1,y:t.y}}}},{key:"manhattanDistance",value:function(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}},{key:"setHasThisPoint",value:function(t,e){var n=!0,o=!1,r=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var a=i.value;if(a.x===e.x&&a.y===e.y)return!0}}catch(t){o=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw r}}return!1}}]),x}()},{"./logic.js":6,"./structuresAndClasses.js":10,"./svgObjects.js":11}],4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}}(),a=t("./importExport.js");function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var c=function t(e){l(this,t),this.$el=e?$("<"+e+">"):$("<div>")},i=function(t){function n(t){l(this,n);var e=u(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.$el.addClass("helpWindowItem"),e.$el.html(t),e}return r(n,c),n}(),h=function(t){function e(){l(this,e);var t=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.$el.attr("id","help"),t.append(new i("<strong>main menu</strong>: right click")),t.append(new i("drag and drop to <strong>move elements</strong>")),t.append(new i("<strong>middle click</strong> to rotate elements")),t.append(new i("<strong>click <img src='img/gui/help.svg' class='helpicon' alt='help icon'></strong> to display documentation (in czech)")),t}return r(e,c),o(e,[{key:"append",value:function(t){this.$el.append(t.$el)}}]),e}(),f=function(t){function i(t,e,n,o){l(this,i);var r=u(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,o));return r.$el.addClass("button"),r.$el.addClass(t),r.$el.append($("<img>").attr("src","img/gui/"+e+".svg").attr("alt",n).attr("title",n)),r}return r(i,c),i}(),s=function(t){function s(n){l(this,s);var t=u(this,(s.__proto__||Object.getPrototypeOf(s)).call(this));t.$el.attr("id","floatingMenu");var o=void 0,e=new f("import","import","Import a network","a");e.$el.on("click",function(){var t=$("<div>").addClass("importExport").addClass("import"),e="importJSON";t.append($("<textarea></textarea>").attr("id",e)).append($("<a>").attr({href:"#",class:"upload"}).append($("<img>").attr("src","img/gui/import.svg")).append(" import from JSON").on("click",function(){var t=$("#"+e).val();o.close(),new a.importNetwok(n,t)})),o=lity(t)}),t.append(e);var r=new f("export","export","Export this network","a");r.$el.on("click",function(){var t=new a.exportNetwork(n),e=$("<div>").addClass("importExport").addClass("export");e.append($("<pre>").append($("<code>").text(t.json(a.exportNetwork.style.pretty)))),e.append($("<a>").attr({href:t.json(a.exportNetwork.style.pretty,!0),class:"download",download:"network.json"}).append($("<img>").attr("src","img/gui/export.svg")).append(" expanded JSON")),e.append($("<a>").attr({href:t.json(a.exportNetwork.style.compact,!0),class:"download",download:"network.min.json"}).append($("<img>").attr("src","img/gui/export.svg")).append(" compact JSON")),lity(e)}),t.append(r);var i=new f("help","help","Display help","a");return i.$el.on("mouseover",function(){$("#help").addClass("visible")}).on("mouseout",function(){$("#help").removeClass("visible")}),i.$el.attr({href:"./docs/user.html","data-lity":""}),t.append(i),n.$svg.after(t.$el),n.$svg.after((new h).$el),t}return r(s,c),o(s,[{key:"append",value:function(t){this.$el.append(t.$el)}}]),s}();n.default=s},{"./importExport.js":5}],5:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}}();function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.exportNetwork=function(){function e(t){r(this,e),this.parentSVG=t}return o(e,[{key:"json",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:e.style.compact;if(1<arguments.length&&void 0!==arguments[1]&&arguments[1])return"data:application/json;charset=utf-8,"+encodeURIComponent(this.json(t));switch(t){case e.style.compact:return JSON.stringify(this.exportData);case e.style.pretty:return JSON.stringify(this.exportData,null,2)}}},{key:"exportData",get:function(){return this.parentSVG.exportData}}],[{key:"style",get:function(){return{pretty:0,compact:1}}}]),e}(),n.importNetwok=function t(e,n){r(this,t),e.importData(JSON.parse(n))}},{}],6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}}();var r=function(){function n(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n)}return o(n,null,[{key:"and",value:function(t,e){return n.testLogicRulesSymmetric(t,e,[[n.state.on,n.state.on,n.state.on],[n.state.on,n.state.off,n.state.off],[n.state.on,n.state.unknown,n.state.unknown],[n.state.on,n.state.oscillating,n.state.oscillating],[n.state.off,n.state.off,n.state.off],[n.state.off,n.state.unknown,n.state.off],[n.state.off,n.state.oscillating,n.state.off],[n.state.unknown,n.state.unknown,n.state.unknown],[n.state.unknown,n.state.oscillating,n.state.unknown],[n.state.oscillating,n.state.oscillating,n.state.oscillating]])}},{key:"nand",value:function(t,e){return n.not(n.and(t,e))}},{key:"nor",value:function(t,e){return n.not(n.or(t,e))}},{key:"not",value:function(t){return t===n.state.on?n.state.off:t===n.state.off?n.state.on:t}},{key:"or",value:function(t,e){return n.testLogicRulesSymmetric(t,e,[[n.state.on,n.state.on,n.state.on],[n.state.on,n.state.off,n.state.on],[n.state.on,n.state.unknown,n.state.on],[n.state.on,n.state.oscillating,n.state.on],[n.state.off,n.state.off,n.state.off],[n.state.off,n.state.unknown,n.state.unknown],[n.state.off,n.state.oscillating,n.state.oscillating],[n.state.unknown,n.state.unknown,n.state.unknown],[n.state.unknown,n.state.oscillating,n.state.unknown],[n.state.oscillating,n.state.oscillating,n.state.oscillating]])}},{key:"xnor",value:function(t,e){return n.not(n.xor(t,e))}},{key:"xor",value:function(t,e){return n.testLogicRulesSymmetric(t,e,[[n.state.on,n.state.on,n.state.off],[n.state.on,n.state.off,n.state.on],[n.state.on,n.state.unknown,n.state.unknown],[n.state.on,n.state.oscillating,n.state.oscillating],[n.state.off,n.state.off,n.state.off],[n.state.off,n.state.unknown,n.state.unknown],[n.state.off,n.state.oscillating,n.state.oscillating],[n.state.unknown,n.state.unknown,n.state.unknown],[n.state.unknown,n.state.oscillating,n.state.unknown],[n.state.oscillating,n.state.oscillating,n.state.oscillating]])}},{key:"testLogicRulesSymmetric",value:function(t,e,n){for(var o=0;o<n.length;o++)if(n[o][0]===t&&n[o][1]===e||n[o][0]===e&&n[o][1]===t)return n[o][2]}},{key:"state",get:function(){return{unknown:0,on:1,off:2,oscillating:3}}}]),n}();n.default=r},{}],7:[function(t,e,n){"use strict";var o,r=t("./canvas.js"),i=(o=r)&&o.__esModule?o:{default:o};$(function(){new i.default("svg#canvas",10)})},{"./canvas.js":1}],8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o,r=function(){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}}(),i=t("./logic.js"),h=(o=i)&&o.__esModule?o:{default:o};function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(t){s(this,e),this.parentSVG=t,this.predecessors=new Map,this.waves=new Map,this.wave=0,this.cycledConnectors=new Map,this.resolvedCycledConnectors=new Set}return r(e,[{key:"run",value:function(){for(this.wave++;this.waves.has(this.wave);)this.step(),this.waves.delete(this.wave),this.wave++}},{key:"step",value:function(){var t=!0,e=!1,n=void 0;try{for(var o,r=this.waves.get(this.wave)[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var i=o.value,s=i.connectorId,a=i.state,u=i.whoCausedIt;if(!this.resolvedCycledConnectors.has(s)){if(this.cycledConnectors.has(s)){var l=this.cycledConnectors.get(s);l.has(a)?(1<l.size&&(a=h.default.state.oscillating),this.resolvedCycledConnectors.add(s)):l.add(a),this.cycledConnectors.set(s,l)}this.whoCausedIt=s,u&&this.addPredecessor(s,u),!this.cycledConnectors.has(s)&&this.getAllPredecessors(s).has(s)&&this.cycledConnectors.set(s,new Set([a]));var c=this.parentSVG.getConnectorById(s);c&&c.setState(a)}}}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}this.whoCausedIt=void 0}},{key:"addPredecessor",value:function(t,e){this.predecessors.has(t)||this.predecessors.set(t,new Set),this.predecessors.get(t).add(e)}},{key:"getAllPredecessors",value:function(t){this.predecessors.has(t)||this.predecessors.set(t,new Set);var e=new Set;this.predecessors.get(t).forEach(e.add,e);for(var n=0,o=e.size;n<o;){var r=!0,i=!1,s=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var l=a.value;this.predecessors.has(l)&&this.predecessors.get(l).forEach(e.add,e)}}catch(t){i=!0,s=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw s}}n=o,o=e.size}return e}},{key:"notifyChange",value:function(t,e){var n=this.wave+1;this.waves.has(n)||this.waves.set(n,[]),this.waves.get(n).push(new function t(e,n,o){s(this,t),this.connectorId=e,this.state=n,this.whoCausedIt=o}(t,e,this.whoCausedIt))}}]),e}();n.default=a},{"./logic.js":6}],9:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return o(t,null,[{key:"deepCopy",value:function(t){return $.extend(!0,[],t)}},{key:"addMouseScrollEventListener",value:function(t,e){var n=function(t){return(t=window.event||t).delta=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)),e(t),!1},o=document.querySelector(t);o.addEventListener?(o.addEventListener("mousewheel",n,!1),o.addEventListener("DOMMouseScroll",n,!1)):o.attachEvent("onmousewheel",n),o.addEventListener("mousewheel",function(t){console.log("event",t)},!1)}}]),t}();n.default=r},{}],10:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}}();function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=null;n.Id=function(){function t(){return r(this,t),i||(i=this),this.prefix="id",this.nextId=0,i}return o(t,[{key:"generate",value:function(){return this.prefix+this.nextId}},{key:"unique",get:function(){for(var t=this.generate();$("#"+t).length;)this.nextId++,t=this.generate();return this.nextId++,t}}]),t}(),n.MapWithDefaultValue=function(){function e(t){r(this,e),this.map=new Map,this.default=t}return o(e,[{key:"clear",value:function(){return this.map.clear()}},{key:"forEach",value:function(){var t;return(t=this.map).forEach.apply(t,arguments)}},{key:"get",value:function(t){return this.map.get(t)}},{key:"delete",value:function(t){return this.map.delete(t)}},{key:"set",value:function(t,e){return this.map.set(t,e)}},{key:"has",value:function(t){return this.map.has(t)}},{key:"entries",value:function(){return this.map.entries()}},{key:"keys",value:function(){return this.map.keys()}},{key:"values",value:function(){return this.map.values()}},{key:"size",get:function(){return this.map.size}}]),e}()},{}],11:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Pattern=n.PolyLine=n.PolylinePoints=n.PolylinePoint=n.Group=n.SvgImage=n.Rectangle=void 0;var o=function(){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}}(),r=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(t("./structuresAndClasses.js"));function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(t){l(this,e),this.tagName=t,this.$el=$("<"+this.tagName+">"),this.id=(new r.Id).unique}return o(e,[{key:"addClass",value:function(t){this.$el.addClass(t)}},{key:"removeClasses",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var o=!0,r=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(o=(s=a.next()).done);o=!0){var u=s.value;this.$el.removeClass(u)}}catch(t){r=!0,i=t}finally{try{!o&&a.return&&a.return()}finally{if(r)throw i}}}},{key:"addAttr",value:function(t){this.checkIfElementExistsInDOM(),this.$el.attr(t)}},{key:"getAttr",value:function(t){return this.checkIfElementExistsInDOM(),this.$el.attr(t)}},{key:"removeAttr",value:function(t){this.checkIfElementExistsInDOM(),this.$el.removeAttr(t)}},{key:"get",value:function(){return this.checkIfElementExistsInDOM(),this.$el}},{key:"checkIfElementExistsInDOM",value:function(){var t=$("#"+this.$el.attr("id"));t.length&&(this.$el=t)}},{key:"id",set:function(t){this.addAttr({id:t})},get:function(){return this.getAttr("id")}}]),e}(),a=function(t){function e(t){return l(this,e),u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return i(e,s),o(e,[{key:"draggable",value:function(t){this.addAttr({draggable:t})}}]),e}(),c=(function(t){function e(t){return l(this,e),u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}i(e,s),o(e,[{key:"rotatable",value:function(t){this.addAttr({rotatable:t})}}])}(),function(t){function e(t){return l(this,e),u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return i(e,a),o(e,[{key:"rotatable",value:function(t){this.addAttr({rotatable:t})}}]),e}()),h=function(t){function s(t,e,n,o,r){l(this,s);var i=u(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,r));return i.addAttr({x:t,y:e,width:n,height:o}),i}return i(s,c),s}(),f=(n.Rectangle=function(t){function a(t,e,n,o,r,i){l(this,a);var s=u(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t,e,n,o,"rect"));return s.addAttr({fill:r,stroke:i,"stroke-width":.5,"pointer-events":"all"}),s}return i(a,h),a}(),n.SvgImage=function(t){function s(t,e,n,o,r){l(this,s);var i=u(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,t,e,n,o,"image"));return i.addAttr({"xlink:href":r}),i}return i(s,h),o(s,[{key:"changeUrl",value:function(t){this.addAttr({"xlink:href":t})}}]),s}(),n.Group=function(t){function e(){return l(this,e),u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"g"))}return i(e,c),o(e,[{key:"addChild",value:function(t){return this.$el.append(t.$el),t}}]),e}(),n.PolylinePoint=function(){function n(t,e){l(this,n),this.x=0,void(this.y=0)!==t&&void 0!==e&&(this.x=t,this.y=e)}return o(n,[{key:"set",value:function(t,e){this.x=t,this.y=e}},{key:"string",get:function(){return this.x+","+this.y}}],[{key:"parseFromString",value:function(t){var e=t.split(",");return new n(e[0],e[1])}},{key:"equals",value:function(t,e){return t.x===e.x&&t.y===e.y}}]),n}()),d=function(){function e(t){l(this,e),this.arr=void 0!==t?t:[]}return o(e,[{key:"copy",value:function(){return e($.extend(!0,[],this.arr))}},{key:"append",value:function(t){return this.addWithIndex(t,this.arr.length)}},{key:"prepend",value:function(t){return this.addWithIndex(t,0)}},{key:"addWithIndex",value:function(t,e){for(var n=this.arr.length;e<n;--n)this.arr[n]=this.arr[n-1];return this.arr[e]=t,this}},{key:"getItem",value:function(t){return this.arr[t]}},{key:"remove",value:function(t){for(var e=this.length,n=t;n<e;++n)this.arr[n]=this.arr[n+1];this.arr.pop()}},{key:"length",get:function(){return this.arr.length}},{key:"last",get:function(){return 0!==this.length&&this.arr[this.length-1]}},{key:"first",get:function(){return 0!==this.length&&this.arr[0]}}]),e}();n.PolylinePoints=function(t){function r(t){return l(this,r),u(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t))}return i(r,d),o(r,[{key:"copy",value:function(){return new r($.extend(!0,[],this.arr))}},{key:"append",value:function(t){(function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(o):void 0})(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"append",this).call(this,t);var e=this.length;return 3<=e&&(this.getItem(e-3).x===this.getItem(e-2).x&&this.getItem(e-2).x===this.getItem(e-1).x||this.getItem(e-3).y===this.getItem(e-2).y&&this.getItem(e-2).y===this.getItem(e-1).y)&&this.remove(e-2),this}},{key:"forEach",value:function(t){for(var e=0;e<this.arr.length;++e)t(this.arr[e])}},{key:"string",get:function(){for(var t="",e=0;e<this.length;++e)0!==e&&(t+=" "),t+=this.arr[e].string;return t}}],[{key:"parseFromString",value:function(t){for(var e=t.split(" "),n=new r,o=0;o<e.length;++o)n.append(f.parseFromString(e[o]));return n}}]),r}(),n.PolyLine=function(t){function r(t,e,n){l(this,r);var o=u(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,"polyline"));return o.addAttr({points:t.string,stroke:e,fill:"none","stroke-width":n}),o}return i(r,s),o(r,[{key:"updatePoints",value:function(t){this.addAttr({points:t.string})}}]),r}(),n.Pattern=function(t){function r(t,e,n){l(this,r);var o=u(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,"pattern"));return o.addAttr({id:t,x:0,y:0,width:e,height:n,patternUnits:"userSpaceOnUse",viewBox:"0 0 "+e+" "+n}),o}return i(r,s),o(r,[{key:"addChild",value:function(t){return this.$el.append(t.$el),t}}]),r}()},{"./structuresAndClasses.js":10}]},{},[7]);